<!doctype html><html lang=en theme=light is-docs-page js-focus-visible-polyfill-available><head><meta charset=utf-8><title>Configure WAF Managed Rules with Terraform · Cloudflare Terraform docs</title><meta http-equiv=cleartype content="on"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=application-name content="Configure WAF Managed Rules with Terraform · Cloudflare Terraform docs"><meta name=msapplication-tap-highlight content="no"><meta name=apple-mobile-web-app-title content="Configure WAF Managed Rules with Terraform · Cloudflare Terraform docs"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-capable content="yes"><meta name=mobile-web-app-capable content="yes"><meta name=theme-color content="#f38020"><meta name=description content="With Cloudflare’s Terraform provider, you can manage your edge using the same familiar tools you use to automate the rest of your infrastructure. Define and store configuration in source code repositories like GitHub, track and version changes over time, and roll back when needed—all without needing to learn the Cloudflare APIs"><meta property="og:image" content="https://panthere2k.github.io/core-services-preview.png"><meta property="og:title" content="Configure WAF Managed Rules with Terraform · Cloudflare Terraform docs"><meta property="og:description" content="With Cloudflare’s Terraform provider, you can manage your edge using the same familiar tools you use to automate the rest of your infrastructure. Define and store configuration in source code repositories like GitHub, track and version changes over time, and roll back when needed—all without needing to learn the Cloudflare APIs"><meta property="og:type" content="website"><meta name=twitter:title content="Configure WAF Managed Rules with Terraform · Cloudflare Terraform docs"><meta name=twitter:image content="https://panthere2k.github.io/core-services-preview.png"><meta name=twitter:description content="With Cloudflare’s Terraform provider, you can manage your edge using the same familiar tools you use to automate the rest of your infrastructure. Define and store configuration in source code repositories like GitHub, track and version changes over time, and roll back when needed—all without needing to learn the Cloudflare APIs"><meta name=twitter:creator content="@cloudflare"><meta name=twitter:card content="summary_large_image"><meta name=pcx_content_type content="how-to"><link rel=icon href=/favicon-32x32.png><link rel=canonical href=https://panthere2k.github.io/terraform/additional-configurations/waf-managed-rulesets/><link rel=sitemap href=/sitemap.xml type=application/xml><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon sizes=48x48 href=/icons/icon-48x48.png><link rel=apple-touch-icon sizes=72x72 href=/icons/icon-72x72.png><link rel=apple-touch-icon sizes=96x96 href=/icons/icon-96x96.png><link rel=apple-touch-icon sizes=144x144 href=/icons/icon-144x144.png><link rel=apple-touch-icon sizes=192x192 href=/icons/icon-192x192.png><link rel=apple-touch-icon sizes=256x256 href=/icons/icon-256x256.png><link rel=apple-touch-icon sizes=384x384 href=/icons/icon-384x384.png><link rel=apple-touch-icon sizes=512x512 href=/icons/icon-512x512.png><script src=/search.redirect.min.6828ce878577fe91120d67814d68c0d8.js defer></script><link rel="stylesheet preconnect" href=/style.css><script>(function(){let s=!1,e,n;document.readyState!=="loading"?o():addEventListener("DOMContentLoaded",o),e=document.querySelector("#ThemeToggle"),s=!e;function t(n){try{let o=n?"dark":"light";document.documentElement.setAttribute("theme",o),localStorage.theme=JSON.stringify({theme:o}),e?(e.checked=n,s=!1):s&&setTimeout(t,1,n)}catch{}}function o(){e=e||document.querySelector("#ThemeToggle"),e.addEventListener("change",()=>t(!!e.checked)),addEventListener("keydown",n=>{n.target===document.body&&n.which===68&&n.shiftKey&&(n.preventDefault(),t(!e.checked))})}try{n=window.matchMedia("(prefers-color-scheme:dark)"),n.onchange=e=>t(e.matches)}catch{}try{let e=localStorage.theme,s=e&&JSON.parse(e);t(s?/dark/.test(s.theme):!!(n&&n.matches))}catch{}})()</script><script src=/main.min.c2a5e976c412695a3d9389cba84aa5bd.js defer></script>
<script data-source=docs defer src=https://feedback.developers.cloudflare.com/sdk.js></script>
<link rel=preload href=https://feedback.developers.cloudflare.com/sdk.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://feedback.developers.cloudflare.com/sdk.css></noscript></head><body><div class=DocsPage><div><a class=skip-link href=#main>Skip to content</a></div><div class=DocsMobileHeader><a class="DocsMobileHeader--cloudflare-logo-link Link Link-without-underline" href=/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsMobileTitleHeader><a aria-current=page class="DocsMobileTitleHeader--logo-link Link Link-without-underline" href=/terraform/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><span title="Cloudflare Terraform logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 55"><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z" fill="url(#a)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z" fill="url(#b)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z" fill="url(#c)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z" fill="url(#d)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z" fill="url(#e)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z" fill="url(#f)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z" fill="url(#g)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z" fill="url(#h)"/><defs><linearGradient id="a" x1="23.997" y1="9.612" x2="23.997" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="b" x1="23.997" y1="9.612" x2="23.997" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="c" x1="40.544" y1="9.612" x2="40.544" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="d" x1="40.544" y1="9.612" x2="40.544" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="e" x1="7.455" y1="0" x2="7.455" y2="25.828" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="f" x1="7.455" y1="0" x2="7.455" y2="25.828" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="g" x1="23.997" y1="28.716" x2="23.997" y2="54.54" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="h" x1="23.997" y1="28.716" x2="23.997" y2="54.54" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient></defs></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:9>Terraform</span></span></div></a><button class="Button DocsMobileTitleHeader--sidebar-toggle-button">
<span class=DocsMobileTitleHeader--sidebar-toggle-button-icon aria-hidden=true><svg viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="title-1332672649688018" xmlns="http://www.w3.org/2000/svg"><title id="title-1332672649688018">Navigation menu icon</title><path data-index="1" d="M5 7h10" transform-origin="10 7"/><path data-index="2" d="M5 10h10" transform-origin="10 10"/><path data-index="3" d="M5 13h10" transform-origin="10 13"/></svg><span is-visually-hidden>Open external link</span></span></button></div><div class=DocsMobileNavBackdrop></div><div class=DocsSidebar><div class=DocsSidebar--sections><div class="DocsSidebar--section DocsSidebar--header-section"><a class="DocsSidebar--cloudflare-logo-link DocsSidebar--link" href=/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsSidebar--section-separator></div><div class="DocsSidebar--section DocsSidebar--docs-title-section"><a aria-current=page class="DocsSidebar--docs-title-logo-link DocsSidebar--link" href=/terraform/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><span title="Cloudflare Terraform logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 55"><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z" fill="url(#a)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 9.612 14.91 8.61v17.214l-14.91-8.606V9.612z" fill="url(#b)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z" fill="url(#c)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.089 18.221v17.215l14.91-8.606V9.612l-14.91 8.61z" fill="url(#d)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z" fill="url(#e)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M0 0v17.219l14.91 8.61V8.608L0 0z" fill="url(#f)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z" fill="url(#g)"/><path fill-rule="evenodd" clip-rule="evenodd" d="m16.542 45.93 14.91 8.61V37.325l-14.91-8.61v17.216z" fill="url(#h)"/><defs><linearGradient id="a" x1="23.997" y1="9.612" x2="23.997" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="b" x1="23.997" y1="9.612" x2="23.997" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="c" x1="40.544" y1="9.612" x2="40.544" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="d" x1="40.544" y1="9.612" x2="40.544" y2="35.436" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="e" x1="7.455" y1="0" x2="7.455" y2="25.828" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="f" x1="7.455" y1="0" x2="7.455" y2="25.828" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="g" x1="23.997" y1="28.716" x2="23.997" y2="54.54" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="h" x1="23.997" y1="28.716" x2="23.997" y2="54.54" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient></defs></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:9>Terraform</span></span></div></a><div class="DocsSidebar--section-more Dropdown" data-expanded=false><button class="DocsSidebar--section-more-button Button" aria-expanded=false><div class=DocsSidebar--section-more-button-icon><svg viewBox="0 0 4 16" stroke="currentcolor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" fill="currentcolor" role="img" aria-labelledby="title-6032186738345315" xmlns="http://www.w3.org/2000/svg"><title id="title-6032186738345315">Dropdown icon</title><path d="M2 2v0m0 6v0m0 6v0z"/></svg><span is-visually-hidden>Terraform menu</span></div></button><div class="DocsSidebar--section-more-dropdown Dropdown--dropdown"><ul class=Dropdown--list><li class=Dropdown--item><a class=Dropdown--link href=https://github.com/cloudflare/terraform-provider-cloudflare tabindex=-1>GitHub @cloudflare/terraform-provider-cloudflare</a></li><li class=Dropdown--item><a class=Dropdown--link href=https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/record tabindex=-1>Cloudflare in the Terraform registry</a></li><li class=Dropdown--item><a class=Dropdown--link href=https://www.hashicorp.com/integrations/cloudflare/terraform tabindex=-1>Hashicorp Cloudflare integration</a></li><li class=Dropdown--item><a class=Dropdown--link href=https://www.terraform.io/ tabindex=-1>Terraform homepage</a></li><li class=Dropdown--item><a class=Dropdown--link href=https://cloudflare.com tabindex=-1>Cloudflare homepage</a></li></ul></div></div></div><div class="DocsSidebar--section DocsSidebar--nav-section" style=position:relative;overflow:hidden;width:100%;height:100%><div style=position:absolute;inset:0;overflow-y:auto;margin-right:0;margin-bottom:0><div class=DocsSidebar--nav-section-shadow style=opacity:0></div><ul class=DocsSidebar--nav><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Overview</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/installing/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Get started</span></a></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Tutorials</span>
</button><a class=DocsSidebar--nav-link href=/terraform/tutorial/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Tutorials</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/initialize-terraform/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>1 – Initialize Terraform</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/track-history/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>2 – Track your history</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/configure-https-settings/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>3 – Configure HTTPS settings</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/use-load-balancing/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>4 – Improve performance</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/add-page-rules/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>5 – Add exceptions with Page Rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/tutorial/revert-configuration/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>6 – Revert configuration</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Additional configurations</span>
</button><a class=DocsSidebar--nav-link href=/terraform/additional-configurations/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Additional configurations</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style=min-height:0;transition-duration:400ms is-expanded><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item is-active><a aria-current=page class=DocsSidebar--nav-link href=/terraform/additional-configurations/waf-managed-rulesets/ is-active><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>WAF Managed Rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/additional-configurations/ddos-managed-rulesets/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>DDoS managed rulesets</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/additional-configurations/rate-limiting-rules/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Rate limiting rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/additional-configurations/waf-custom-rules/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>WAF custom rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/additional-configurations/transform-rules/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Transform Rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/rules/url-forwarding/single-redirects/terraform-example/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Single Redirects</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/rules/configuration-rules/terraform-example/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Configuration Rules</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/rules/origin-rules/terraform-example/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Origin Rules</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/cache/about/cache-rules/#terraform-example><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Cache Rules</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Advanced topics</span>
</button><a class=DocsSidebar--nav-link href=/terraform/advanced-topics/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Advanced topics</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/advanced-topics/import-cloudflare-resources/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Import Cloudflare resources</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/terraform/advanced-topics/provider-customization/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Provider customization</span></a></li></ul></div></div></div></div></li></ul></div><div style=position:absolute;height:6px;display:none;right:2px;bottom:2px;left:2px;border-radius:3px><div style=position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)></div></div><div style=position:absolute;width:6px;display:none class="Scrollbars--track Scrollbars--track-vertical"><div style=position:relative;display:block;width:100% class="Scrollbars--thumb Scrollbars--thumb-vertical"></div></div></div><div class=toggleSidebar><button id=toggleSidebarButton style=width:2em;height:2em title="Click to collapse and expand the sidebar navigation"><svg id="toggleSidebarSVG" aria-hidden="true" height="1" width="1" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path id="toggleSidebarSVGPath" d="M15 2a1 1 0 00-1 1v10a1 1 0 002 0V3a1 1 0 00-1-1zm-10.407.993-4.3 4.3a1 1 0 000 1.414l4.3 4.3a1 1 0 001.415-1.416L3.417 9H10a1 1 0 100-2H3.417l2.591-2.591A1 1 0 104.593 2.993z"/></svg></button></div></div><div class=DocsSidebar--shadow></div></div><div class=DocsToolbar><div class=DocsToolbar--search><div class=DocsSearch><div class=DocsSearch--input-wrapper><input type=text id=DocsSearch--input class=DocsSearch--input spellcheck=false autocomplete=false placeholder="Search docs..."><div class=DocsSearch--input-icon><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-9701125841014673" xmlns="http://www.w3.org/2000/svg"><title id="title-9701125841014673">Search icon (depiction of a magnifying glass)</title><path d="M11.999 10.585l3.458 3.458a1 1 0 01-1.414 1.414L10.585 12a6.5 6.5.0 111.414-1.414zM6.75 11.5a4.75 4.75.0 100-9.5 4.75 4.75.0 000 9.5z"/></svg></div><button disabled class=slashPlaceholder title="Press '/' to focus on the search bar" aria-label="Forward slash keyboard shortcut" tabindex=-1 type=button><div style=margin-top:-1px>/</span></div></button></div></div></div><div class=DocsToolbar--tools><button data-feedback=true class="DocsToolbar--feedback Button Button-is-docs-secondary">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17"><path d="M14 2.5H2l-.5.5v11.165l.863.345 2.852-3.01H14l.5-.5V3l-.5-.5zm-.5 8H4.785L2.5 12.911V3.5h11v7z" fill="currentcolor"/><path d="M12.5 5.003h-9v1h9v-1zm0 2.497h-9v1h9v-1z" fill="currentcolor"/></svg>Give Feedback</button><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--tools-icon-item><div class=Tooltip---root><div class=DocsToolbar--tools-icon-item-content><a class="Link Link-without-underline" href=https://github.com/cloudflare/cloudflare-docs><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-6991762763429039" xmlns="http://www.w3.org/2000/svg"><title id="title-6991762763429039">GitHub icon</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"/></svg></a></div><span class=Tooltip role=tooltip position=bottom-end>Visit Terraform on GitHub</span></div></div><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--theme-toggle><div class=Tooltip---root><div class=ThemeToggle><input type=checkbox id=ThemeToggle class=ThemeToggle--input>
<label class=ThemeToggle--toggle for=ThemeToggle><div class=ThemeToggle--toggle-handle></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--sun"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-8812071124069258" xmlns="http://www.w3.org/2000/svg"><title id="title-8812071124069258">Light theme icon (depiction of a sun)</title><path d="M7.5 11.465a3.482 3.482.0 01-1.596-.662L4.11 12.596a.5.5.0 01-.707-.707l1.793-1.793A3.482 3.482.0 014.535 8.5H2a.5.5.0 010-1h2.535a3.482 3.482.0 01.662-1.596L3.404 4.11a.5.5.0 01.707-.707l1.793 1.793A3.482 3.482.0 017.5 4.535V2a.5.5.0 011 0v2.535a3.482 3.482.0 011.596.662l1.793-1.793a.5.5.0 01.707.707l-1.793 1.793c.343.458.577 1.003.662 1.596H14a.5.5.0 110 1h-2.535a3.482 3.482.0 01-.662 1.596l1.793 1.793a.5.5.0 01-.707.707l-1.793-1.793a3.482 3.482.0 01-1.596.662V14a.5.5.0 11-1 0v-2.535z"/></svg></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--moon"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-5971296394189265" xmlns="http://www.w3.org/2000/svg"><title id="title-5971296394189265">Dark theme icon (depiction of a moon)</title><path d="M7.067 3.087a5 5 0 005.466 7.026A5 5 0 117.067 3.087z"/></svg></div></label><span class=Tooltip role=tooltip position=bottom-end>Set theme to dark (⇧+D)</span></div></div></div></div></div><main class=DocsBody><div id=docs-content data-reach-skip-nav-content></div><div class=DocsContent id=main page-type=overview><article class=DocsMarkdown><h1 id=configure-waf-managed-rules>Configure WAF Managed Rules</h1><p>This page provides examples of deploying and configuring WAF Managed Rules in your zone or account using Terraform. It covers the following configurations:</p><ul><li><a href=#deploy-managed-rulesets class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Deploy managed rulesets</span></a></li><li><a href=#configure-skip-rules class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Configure skip rules</span></a></li><li><a href=#configure-payload-logging class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Configure payload logging</span></a></li><li><a href=#configure-overrides class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Configure overrides</span></a></li><li><a href=#configure-the-owasp-paranoia-level-score-threshold-and-action class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Configure the OWASP paranoia level, score threshold, and action</span></a></li></ul><p>For more information on WAF Managed Rules, refer to <a href=/waf/managed-rules/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Managed Rules</span></a> in the Cloudflare WAF documentation. For more information on deploying and configuring rulesets using the Rulesets API, refer to <a href=/ruleset-engine/managed-rulesets/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Work with managed rulesets</span></a> in the Ruleset Engine documentation.</p><h2 id=before-you-start><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#before-you-start>&#8203;​</a></span>
<span>Before you start</span></h2><h3 id=delete-any-existing-rulesets-before-using-terraform><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#delete-any-existing-rulesets-before-using-terraform>&#8203;​</a></span>
<span>Delete any existing rulesets before using Terraform</span></h3><p>Terraform assumes that it has complete control over account and zone rulesets. Before you can start configuring your account and zone using Terraform, you must delete existing rulesets (any ruleset with <code>kind: root</code> or <code>kind: zone</code> at the account and zone level, respectively), and then recreate them using Terraform.</p><p>Cloudflare recommends that you delete rulesets in both scopes (account and zone) so that you can manage them all using Terraform. However, you can also manage rulesets for only one of the scopes: account or zone. In this case, delete the rulesets in the desired scope before you start managing rulesets using Terraform.</p><p>To find existing entry point rulesets, use the API operations described in <a href=/ruleset-engine/rulesets-api/view/#list-existing-rulesets class=DocsMarkdown--link><span class=DocsMarkdown--link-content>List existing rulesets</span></a>, for the account and zone levels. To delete existing rulesets, use the API operations described in <a href=/ruleset-engine/rulesets-api/delete/#delete-ruleset class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Delete ruleset</span></a>, for the account and zone levels.</p><h3 id=obtain-the-necessary-account-zone-and-managed-ruleset-ids><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#obtain-the-necessary-account-zone-and-managed-ruleset-ids>&#8203;​</a></span>
<span>Obtain the necessary account, zone, and managed ruleset IDs</span></h3><p>The Terraform configurations provided in this page need the zone ID (or account ID) of the zone/account where you will deploy managed rulesets.</p><ul><li>To retrieve the list of accounts you have access to, including their IDs, use the <a href=https://developers.cloudflare.com/api/operations/accounts-list-accounts class=DocsMarkdown--link><span class=DocsMarkdown--link-content>List accounts</span></a> API operation.</li><li>To retrieve the list of zones you have access to, including their IDs, use the <a href=https://developers.cloudflare.com/api/operations/zone-list-zones class=DocsMarkdown--link><span class=DocsMarkdown--link-content>List zones</span></a> API operation.</li></ul><p>The deployment of managed rulesets via Terraform requires that you use the ruleset IDs. To find the IDs of WAF&rsquo;s managed rulesets, use the <a href=https://developers.cloudflare.com/api/operations/account-rulesets-list-account-rulesets class=DocsMarkdown--link><span class=DocsMarkdown--link-content>List account rulesets</span></a> API operation. The response will include the description and IDs of the existing managed rulesets.</p><h2 id=deploy-managed-rulesets><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#deploy-managed-rulesets>&#8203;​</a></span>
<span>Deploy managed rulesets</span></h2><p>The following example deploys two managed rulesets to a zone using Terraform, using a <code>cloudflare_ruleset</code> resource with two rules that execute the managed rulesets.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=c1># Configure a ruleset at the zone level for the &#34;http_request_firewall_managed&#34; phase
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>resource</span> <span class=s2>&#34;cloudflare_ruleset&#34;</span> <span class=s2>&#34;zone_level_managed_waf&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=na>zone_id</span>     = <span class=s2>&#34;&lt;ZONE_ID&gt;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>name</span>        = <span class=s2>&#34;Managed WAF entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>description</span> = <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>kind</span>        = <span class=s2>&#34;zone&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>phase</span>       = <span class=s2>&#34;http_request_firewall_managed&#34;</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare Managed Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>version</span> = <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Execute Cloudflare Managed Ruleset on my zone-level phase entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare OWASP Core Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;4814384a9e5d4991b9815dcfc25d2f1f&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>version</span> = <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Execute Cloudflare OWASP Core Ruleset on my zone-level phase entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=configure-skip-rules><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#configure-skip-rules>&#8203;​</a></span>
<span>Configure skip rules</span></h2><p>The following example adds two <a href=/waf/managed-rules/waf-exceptions/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>skip rules</span></a> (or WAF exceptions) for the Cloudflare Managed Ruleset:</p><ul><li>The first rule will skip the execution of the entire Cloudflare Managed Ruleset (with ID <code>efb7b8c949ac4650a09736fc376e9aee</code>) for specific URLs, according to the rule expression.</li><li>The second rule will skip the execution of two rules belonging to the Cloudflare Managed Ruleset for specific URLs, according to the rule expression.</li></ul><p>Add the two skip rules to the <code>cloudflare_ruleset</code> resource before the rule that deploys the Cloudflare Managed Ruleset:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=nx>highlight</span><span class=o>:</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span><span class=m>2</span><span class=p>,</span><span class=m>3</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=m>5</span><span class=p>,</span><span class=m>6</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=m>8</span><span class=p>,</span><span class=m>9</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=m>12</span><span class=p>,</span><span class=m>13</span><span class=p>,</span><span class=m>14</span><span class=p>,</span><span class=m>15</span><span class=p>,</span><span class=m>16</span><span class=p>,</span><span class=m>17</span><span class=p>,</span><span class=m>18</span><span class=p>,</span><span class=m>19</span><span class=p>,</span><span class=m>20</span><span class=p>,</span><span class=m>21</span><span class=p>,</span><span class=m>22</span><span class=p>,</span><span class=m>23</span><span class=p>,</span><span class=m>24</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Skip execution of the entire Cloudflare Managed Ruleset for specific URLs
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;skip&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>rulesets</span> = <span class=p>[</span><span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;(cf.zone.name eq </span><span class=err>\</span><span class=s2>&#34;</span><span class=nx>example</span><span class=p>.</span><span class=nx>com</span><span class=err>\</span><span class=s2>&#34; and http.request.uri.query contains </span><span class=err>\</span><span class=s2>&#34;</span><span class=na>skip</span>=<span class=nx>rulesets</span><span class=err>\</span><span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Skip Cloudflare Manage ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Skip execution of two rules in the Cloudflare Managed Ruleset for specific URLs
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;skip&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>rules</span> = <span class=p>{</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>        # Format: &#34;&lt;RULESET_ID&gt;&#34; = &#34;&lt;RULE_ID_1&gt;,&lt;RULE_ID_2&gt;,...&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span> <span class=o>=</span> <span class=s2>&#34;5de7edfa648c4d6891dc3e7f84534ffa,e3a567afc347477d9702d9047e97d760&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;(cf.zone.name eq </span><span class=err>\</span><span class=s2>&#34;</span><span class=nx>example</span><span class=p>.</span><span class=nx>com</span><span class=err>\</span><span class=s2>&#34; and http.request.uri.query contains </span><span class=err>\</span><span class=s2>&#34;</span><span class=na>skip</span>=<span class=nx>rules</span><span class=err>\</span><span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Skip WordPress and SQLi rules&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare Managed Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>version</span> = <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Execute Cloudflare Managed Ruleset on my zone-level phase entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # (...)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><aside class=DocsMarkdown--aside role=note data-type=warning><div class=DocsMarkdown--aside-header>Important</div>Ensure that you place the skip rules <strong>before</strong> the rule that executes the managed ruleset (or some of its rules) that you wish to skip, as in the previous example.</aside><h2 id=configure-overrides><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#configure-overrides>&#8203;​</a></span>
<span>Configure overrides</span></h2><p>The following example adds three <a href=/ruleset-engine/managed-rulesets/override-managed-ruleset/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>overrides</span></a> for the Cloudflare Managed Ruleset:</p><ul><li>A rule override for rule with ID <code>5de7edfa648c4d6891dc3e7f84534ffa</code> setting the action to <code>log</code>.</li><li>A rule override for rule with ID <code>75a0060762034a6cb663fd51a02344cb</code> disabling the rule.</li><li>A tag override for the <code>wordpress</code> tag, setting the action of all the rules with this tag to <code>js_challenge</code>.</li></ul><aside class=DocsMarkdown--aside role=note data-type=warning><div class=DocsMarkdown--aside-header>Important</div><p>Ruleset overrides and tag overrides apply to both existing and <strong>future</strong> rules in the managed ruleset. If you wish to override existing rules only, you must use rule overrides.</p><p>In the rules-level or category-level override, use the <code>status</code> field to indicate whether the override enables or disables the ruleset rules or category.</p></aside><p>The following configuration includes the three overrides in the rule that executes the Cloudflare Managed Ruleset:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=nx>highlight</span><span class=o>:</span> <span class=p>[</span><span class=m>7</span><span class=p>,</span><span class=m>8</span><span class=p>,</span><span class=m>9</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=m>11</span><span class=p>,</span><span class=m>12</span><span class=p>,</span><span class=m>13</span><span class=p>,</span><span class=m>14</span><span class=p>,</span><span class=m>15</span><span class=p>,</span><span class=m>16</span><span class=p>,</span><span class=m>17</span><span class=p>,</span><span class=m>18</span><span class=p>,</span><span class=m>19</span><span class=p>,</span><span class=m>20</span><span class=p>,</span><span class=m>21</span><span class=p>,</span><span class=m>22</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare Managed Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>version</span> = <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nx>overrides</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>id</span> = <span class=s2>&#34;5de7edfa648c4d6891dc3e7f84534ffa&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>action</span> = <span class=s2>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>status</span> = <span class=s2>&#34;enabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>id</span> = <span class=s2>&#34;75a0060762034a6cb663fd51a02344cb&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>status</span> = <span class=s2>&#34;disabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>categories</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>category</span> = <span class=s2>&#34;wordpress&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>action</span> = <span class=s2>&#34;js_challenge&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>status</span> = <span class=s2>&#34;enabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Execute Cloudflare Managed Ruleset on my zone-level phase entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=configure-payload-logging><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#configure-payload-logging>&#8203;​</a></span>
<span>Configure payload logging</span></h2><p>This example enables <a href=/waf/managed-rules/payload-logging/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>payload logging</span></a> for matched rules of the Cloudflare Managed Ruleset, setting the public key used to encrypt the logged payload.</p><p>Building upon the rule that deploys the Cloudflare Managed Ruleset, the following configuration adds the <code>matched_data</code> object with the public key used to encrypt the payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=nx>highlight</span><span class=o>:</span> <span class=p>[</span><span class=m>7</span><span class=p>,</span><span class=m>8</span><span class=p>,</span><span class=m>9</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare Managed Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;efb7b8c949ac4650a09736fc376e9aee&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>version</span> = <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nx>matched_data</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>         <span class=na>public_key</span> = <span class=s2>&#34;Ycig/Zr/pZmklmFUN99nr+taURlYItL91g+NcHGYpB8=&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;Execute Cloudflare Managed Ruleset on my zone-level phase entry point ruleset&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=configure-the-owasp-paranoia-level-score-threshold-and-action><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#configure-the-owasp-paranoia-level-score-threshold-and-action>&#8203;​</a></span>
<span>Configure the OWASP paranoia level, score threshold, and action</span></h2><p>The OWASP Managed Ruleset supports the following configurations:</p><ul><li><p>Enable all the rules up to a specific paranoia level by creating tag overrides that disable all the rules associated with higher paranoia levels.</p></li><li><p>Set the action to perform when the calculated threat score is greater than the score threshold by creating a rule override for the last rule in the Cloudflare OWASP Core Ruleset (rule with ID <code>6179ae15870a4bb7b2d480d4843b323c</code>), and including the <code>action</code> property.</p></li><li><p>Set the score threshold by creating a rule override for the last rule in the Cloudflare OWASP Core Ruleset (rule with ID <code>6179ae15870a4bb7b2d480d4843b323c</code>), and including the <code>score_threshold</code> property.</p></li></ul><p>For more information on the available configuration values, refer to the <a href=/waf/managed-rules/reference/owasp-core-ruleset/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Cloudflare OWASP Core Ruleset</span></a> page in the WAF documentation.</p><p>The following example rule of a <code>cloudflare_ruleset</code> Terraform resource performs the following configuration:</p><ul><li>Deploys the OWASP Managed Ruleset.</li><li>Sets the OWASP paranoia level to <em>PL2</em>.</li><li>Sets the score threshold to <code>60</code> (<em>Low</em>).</li><li>Sets the ruleset action to <code>log</code>.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=nx>highlight</span><span class=o>:</span> <span class=p>[</span><span class=m>6</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=m>8</span><span class=p>,</span><span class=m>9</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=m>11</span><span class=p>,</span><span class=m>12</span><span class=p>,</span><span class=m>13</span><span class=p>,</span><span class=m>14</span><span class=p>,</span><span class=m>15</span><span class=p>,</span><span class=m>16</span><span class=p>,</span><span class=m>17</span><span class=p>,</span><span class=m>18</span><span class=p>,</span><span class=m>19</span><span class=p>,</span><span class=m>20</span><span class=p>,</span><span class=m>21</span><span class=p>,</span><span class=m>22</span><span class=p>,</span><span class=m>23</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  # Execute Cloudflare OWASP Core Ruleset
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>action</span> = <span class=s2>&#34;execute&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>action_parameters</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=na>id</span> = <span class=s2>&#34;4814384a9e5d4991b9815dcfc25d2f1f&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nx>overrides</span> <span class=p>{</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>        # By default, all PL1 to PL4 rules are enabled.
</span></span></span><span class=line><span class=cl><span class=c1>        # Set the paranoia level to PL2 by disabling rules with
</span></span></span><span class=line><span class=cl><span class=c1>        # tags &#34;paranoia-level-3&#34; and &#34;paranoia-level-4&#34;.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>categories</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>category</span> = <span class=s2>&#34;paranoia-level-3&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>status</span> = <span class=s2>&#34;disabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>categories</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>category</span> = <span class=s2>&#34;paranoia-level-4&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>status</span> = <span class=s2>&#34;disabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>rules</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=na>id</span> = <span class=s2>&#34;6179ae15870a4bb7b2d480d4843b323c&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>action</span> = <span class=s2>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>score_threshold</span> = <span class=m>60</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=na>expression</span> = <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>description</span> = <span class=s2>&#34;zone&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enabled</span> = <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div></article></div></main><footer class=DocsFooter><div class=DocsFooter--content><div class=DocsFooterResources><span class=DocsFooter--content-additional-wrapper><a href=https://dash.cloudflare.com class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Dashboard</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://community.cloudflare.com class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Community</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://www.cloudflare.com/learning/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Learning Center</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/support" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Support Portal</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span></div><div><span class=DocsFooter--edit-on-gh-link-wrapper><a href=https://github.com/panthere2k/cf-docs/blob/main/content/terraform/additional-configurations/waf-managed-rulesets.md class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Edit on GitHub</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-time>Updated <time class=relative datetime=2023-01-02T09:58:19+09:00 title=2023-01-02>January 2, 2023</time></span></div></div></footer></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKQFGQB" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PKQFGQB")</script><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style></noscript><script defer src=https://unpkg.com/littlefoot/dist/littlefoot.js type=application/javascript></script>
<script type=application/javascript>document.addEventListener("DOMContentLoaded",()=>littlefoot.default())</script></body></html>