<!doctype html><html lang=en theme=light is-docs-page js-focus-visible-polyfill-available><head><meta charset=utf-8><title>Firewall Rules FAQ · Cloudflare Firewall Rules docs</title><meta http-equiv=cleartype content="on"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=application-name content="Firewall Rules FAQ · Cloudflare Firewall Rules docs"><meta name=msapplication-tap-highlight content="no"><meta name=apple-mobile-web-app-title content="Firewall Rules FAQ · Cloudflare Firewall Rules docs"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-capable content="yes"><meta name=mobile-web-app-capable content="yes"><meta name=theme-color content="#f38020"><meta name=description content="Create rules that examine incoming HTTP traffic against a set of powerful filters to block, challenge, log, or allow matching requests."><meta property="og:image" content="https://panthere2k.github.io/core-services-preview.png"><meta property="og:title" content="Firewall Rules FAQ · Cloudflare Firewall Rules docs"><meta property="og:description" content="Create rules that examine incoming HTTP traffic against a set of powerful filters to block, challenge, log, or allow matching requests."><meta property="og:type" content="website"><meta name=twitter:title content="Firewall Rules FAQ · Cloudflare Firewall Rules docs"><meta name=twitter:image content="https://panthere2k.github.io/core-services-preview.png"><meta name=twitter:description content="Create rules that examine incoming HTTP traffic against a set of powerful filters to block, challenge, log, or allow matching requests."><meta name=twitter:creator content="@cloudflare"><meta name=twitter:card content="summary_large_image"><meta name=pcx_content_type content="faq"><link rel=icon href=/favicon-32x32.png><link rel=canonical href=https://panthere2k.github.io/firewall/known-issues-and-faq/><link rel=sitemap href=/sitemap.xml type=application/xml><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon sizes=48x48 href=/icons/icon-48x48.png><link rel=apple-touch-icon sizes=72x72 href=/icons/icon-72x72.png><link rel=apple-touch-icon sizes=96x96 href=/icons/icon-96x96.png><link rel=apple-touch-icon sizes=144x144 href=/icons/icon-144x144.png><link rel=apple-touch-icon sizes=192x192 href=/icons/icon-192x192.png><link rel=apple-touch-icon sizes=256x256 href=/icons/icon-256x256.png><link rel=apple-touch-icon sizes=384x384 href=/icons/icon-384x384.png><link rel=apple-touch-icon sizes=512x512 href=/icons/icon-512x512.png><script src=/search.redirect.min.6828ce878577fe91120d67814d68c0d8.js defer></script><link rel="stylesheet preconnect" href=/style.css><script>(function(){let s=!1,e,n;document.readyState!=="loading"?o():addEventListener("DOMContentLoaded",o),e=document.querySelector("#ThemeToggle"),s=!e;function t(n){try{let o=n?"dark":"light";document.documentElement.setAttribute("theme",o),localStorage.theme=JSON.stringify({theme:o}),e?(e.checked=n,s=!1):s&&setTimeout(t,1,n)}catch{}}function o(){e=e||document.querySelector("#ThemeToggle"),e.addEventListener("change",()=>t(!!e.checked)),addEventListener("keydown",n=>{n.target===document.body&&n.which===68&&n.shiftKey&&(n.preventDefault(),t(!e.checked))})}try{n=window.matchMedia("(prefers-color-scheme:dark)"),n.onchange=e=>t(e.matches)}catch{}try{let e=localStorage.theme,s=e&&JSON.parse(e);t(s?/dark/.test(s.theme):!!(n&&n.matches))}catch{}})()</script><script src=/main.min.c2a5e976c412695a3d9389cba84aa5bd.js defer></script>
<script data-source=docs defer src=https://feedback.developers.cloudflare.com/sdk.js></script>
<link rel=preload href=https://feedback.developers.cloudflare.com/sdk.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://feedback.developers.cloudflare.com/sdk.css></noscript></head><body><div class=DocsPage><div><a class=skip-link href=#main>Skip to content</a></div><div class=DocsMobileHeader><a class="DocsMobileHeader--cloudflare-logo-link Link Link-without-underline" href=/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsMobileTitleHeader><a aria-current=page class="DocsMobileTitleHeader--logo-link Link Link-without-underline" href=/firewall/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><span title="Cloudflare Firewall Rules logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill-rule="evenodd"><path d="m1.5 2 .5-.5h5.5L8 2v3l-.5.5H5.149v2.032L6.08 6.6l.566.566-1.897 1.897L2.85 7.166l.566-.566.932.932V5.5H2L1.5 5V2zM7 4.5v-2H2.5v2H7z"/><path d="M2 14h12l.5-.5v-9L14 4h-3.25l-.5.5V7H8.5l-.5.5V10H2l-.5.5v3l.5.5zm.5-3h2.25v2H2.5v-2zm3.25 2v-2h4.5v2h-4.5zm7.75-5H9v2h4.5V8zm0-1V5h-2.25v2h2.25zm-2.25 4h2.25v2h-2.25v-2z"/></g></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:14>Firewall Rules</span></span></div></a><button class="Button DocsMobileTitleHeader--sidebar-toggle-button">
<span class=DocsMobileTitleHeader--sidebar-toggle-button-icon aria-hidden=true><svg viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="title-1332672649688018" xmlns="http://www.w3.org/2000/svg"><title id="title-1332672649688018">Navigation menu icon</title><path data-index="1" d="M5 7h10" transform-origin="10 7"/><path data-index="2" d="M5 10h10" transform-origin="10 10"/><path data-index="3" d="M5 13h10" transform-origin="10 13"/></svg><span is-visually-hidden>Open external link</span></span></button></div><div class=DocsMobileNavBackdrop></div><div class=DocsSidebar><div class=DocsSidebar--sections><div class="DocsSidebar--section DocsSidebar--header-section"><a class="DocsSidebar--cloudflare-logo-link DocsSidebar--link" href=/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsSidebar--section-separator></div><div class="DocsSidebar--section DocsSidebar--docs-title-section"><a aria-current=page class="DocsSidebar--docs-title-logo-link DocsSidebar--link" href=/firewall/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><span title="Cloudflare Firewall Rules logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill-rule="evenodd"><path d="m1.5 2 .5-.5h5.5L8 2v3l-.5.5H5.149v2.032L6.08 6.6l.566.566-1.897 1.897L2.85 7.166l.566-.566.932.932V5.5H2L1.5 5V2zM7 4.5v-2H2.5v2H7z"/><path d="M2 14h12l.5-.5v-9L14 4h-3.25l-.5.5V7H8.5l-.5.5V10H2l-.5.5v3l.5.5zm.5-3h2.25v2H2.5v-2zm3.25 2v-2h4.5v2h-4.5zm7.75-5H9v2h4.5V8zm0-1V5h-2.25v2h2.25zm-2.25 4h2.25v2h-2.25v-2z"/></g></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:14>Firewall Rules</span></span></div></a><div class="DocsSidebar--section-more Dropdown" data-expanded=false><button class="DocsSidebar--section-more-button Button" aria-expanded=false><div class=DocsSidebar--section-more-button-icon><svg viewBox="0 0 4 16" stroke="currentcolor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" fill="currentcolor" role="img" aria-labelledby="title-6032186738345315" xmlns="http://www.w3.org/2000/svg"><title id="title-6032186738345315">Dropdown icon</title><path d="M2 2v0m0 6v0m0 6v0z"/></svg><span is-visually-hidden>Firewall Rules menu</span></div></button><div class="DocsSidebar--section-more-dropdown Dropdown--dropdown"><ul class=Dropdown--list><li class=Dropdown--item><a class=Dropdown--link href=https://cloudflare.com tabindex=-1>Cloudflare homepage</a></li></ul></div></div></div><div class="DocsSidebar--section DocsSidebar--nav-section" style=position:relative;overflow:hidden;width:100%;height:100%><div style=position:absolute;inset:0;overflow-y:auto;margin-right:0;margin-bottom:0><div class=DocsSidebar--nav-section-shadow style=opacity:0></div><ul class=DocsSidebar--nav><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Overview</span></a></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: About</span>
</button><a class=DocsSidebar--nav-link href=/firewall/cf-firewall-rules/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>About</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-firewall-rules/actions/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Actions</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-firewall-rules/rules-lists/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>IP Lists</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-firewall-rules/order-priority/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Order and priority</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Manage rules in the dashboard</span>
</button><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Manage rules in the dashboard</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/create-edit-delete-rules/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Create, edit, and delete rules</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/edit-expressions/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Edit rule expressions</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/rule-preview/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Preview rules</span></a></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex=-1>
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Use IP Lists</span>
</button><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/rules-lists/ tabindex=-1>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Use IP Lists</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/rules-lists/manage-lists/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Work with lists</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/rules-lists/manage-items/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Manage IP List items</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/rules-lists/use-lists-in-expressions/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Use lists in expressions</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/cf-dashboard/create-mtls-rule/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Create a mTLS rule</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Manage rules via the APIs</span>
</button><a class=DocsSidebar--nav-link href=/firewall/api/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Manage rules via the APIs</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex=-1>
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Firewall Rules API</span>
</button><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/ tabindex=-1>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Firewall Rules API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/json-object/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>JSON object</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/endpoints/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Endpoints</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/post/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>POST example</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/get/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>GET examples</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/put/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>PUT examples</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-firewall-rules/delete/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>DELETE examples</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex=-1>
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Cloudflare Filters API</span>
</button><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/ tabindex=-1>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Cloudflare Filters API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/what-is-a-filter/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>What is a filter?</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/json-object/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>JSON object</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/endpoints/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Endpoints</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/post/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>POST example</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/get/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>GET examples</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/put/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>PUT examples</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/delete/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>DELETE examples</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-filters/validation/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Expression validation</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex=-1>
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Lists API</span>
</button><a class=DocsSidebar--nav-link href=/firewall/api/cf-lists/ tabindex=-1>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Lists API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-lists/json-object/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>JSON object</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/cf-lists/endpoints/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Endpoints</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/api/call-sequence/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Call sequence</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Common use cases</span>
</button><a class=DocsSidebar--nav-link href=/firewall/recipes/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Common use cases</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/block-ms-exchange-autodiscover/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Block Microsoft Exchange Autodiscover requests</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/block-ip-reputation/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Block requests by Threat Score</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/challenge-bad-bots/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Challenge bad bots</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/exempt-partners-hotlink-protection/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Exempt partners from Hotlink Protection</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/require-specific-cookie/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Require a specific cookie</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/require-valid-hmac-token/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Require a valid HMAC token</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/require-specific-headers/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Require specific HTTP headers</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/require-specific-http-ports/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Require specific HTTP ports</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/site-admin-only-known-ips/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Site administration — Require known IP addresses</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/stop-rudy-attacks/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Stop R-U-Dead-Yet? (R.U.D.Y.) attacks</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/firewall/recipes/update-rules-customers-partners/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Update firewall rules for customers or partners</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item is-active><a aria-current=page class=DocsSidebar--nav-link href=/firewall/known-issues-and-faq/ is-active><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>FAQ</span></a></li></ul></div><div style=position:absolute;height:6px;display:none;right:2px;bottom:2px;left:2px;border-radius:3px><div style=position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)></div></div><div style=position:absolute;width:6px;display:none class="Scrollbars--track Scrollbars--track-vertical"><div style=position:relative;display:block;width:100% class="Scrollbars--thumb Scrollbars--thumb-vertical"></div></div></div><div class=toggleSidebar><button id=toggleSidebarButton style=width:2em;height:2em title="Click to collapse and expand the sidebar navigation"><svg id="toggleSidebarSVG" aria-hidden="true" height="1" width="1" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path id="toggleSidebarSVGPath" d="M15 2a1 1 0 00-1 1v10a1 1 0 002 0V3a1 1 0 00-1-1zm-10.407.993-4.3 4.3a1 1 0 000 1.414l4.3 4.3a1 1 0 001.415-1.416L3.417 9H10a1 1 0 100-2H3.417l2.591-2.591A1 1 0 104.593 2.993z"/></svg></button></div></div><div class=DocsSidebar--shadow></div></div><div class=DocsToolbar><div class=DocsToolbar--search><div class=DocsSearch><div class=DocsSearch--input-wrapper><input type=text id=DocsSearch--input class=DocsSearch--input spellcheck=false autocomplete=false placeholder="Search docs..."><div class=DocsSearch--input-icon><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-9701125841014673" xmlns="http://www.w3.org/2000/svg"><title id="title-9701125841014673">Search icon (depiction of a magnifying glass)</title><path d="M11.999 10.585l3.458 3.458a1 1 0 01-1.414 1.414L10.585 12a6.5 6.5.0 111.414-1.414zM6.75 11.5a4.75 4.75.0 100-9.5 4.75 4.75.0 000 9.5z"/></svg></div><button disabled class=slashPlaceholder title="Press '/' to focus on the search bar" aria-label="Forward slash keyboard shortcut" tabindex=-1 type=button><div style=margin-top:-1px>/</span></div></button></div></div></div><div class=DocsToolbar--tools><button data-feedback=true class="DocsToolbar--feedback Button Button-is-docs-secondary">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17"><path d="M14 2.5H2l-.5.5v11.165l.863.345 2.852-3.01H14l.5-.5V3l-.5-.5zm-.5 8H4.785L2.5 12.911V3.5h11v7z" fill="currentcolor"/><path d="M12.5 5.003h-9v1h9v-1zm0 2.497h-9v1h9v-1z" fill="currentcolor"/></svg>Give Feedback</button><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--tools-icon-item><div class=Tooltip---root><div class=DocsToolbar--tools-icon-item-content><a class="Link Link-without-underline" href=https://github.com/cloudflare/cloudflare-docs><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-6991762763429039" xmlns="http://www.w3.org/2000/svg"><title id="title-6991762763429039">GitHub icon</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"/></svg></a></div><span class=Tooltip role=tooltip position=bottom-end>Visit Firewall Rules on GitHub</span></div></div><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--theme-toggle><div class=Tooltip---root><div class=ThemeToggle><input type=checkbox id=ThemeToggle class=ThemeToggle--input>
<label class=ThemeToggle--toggle for=ThemeToggle><div class=ThemeToggle--toggle-handle></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--sun"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-8812071124069258" xmlns="http://www.w3.org/2000/svg"><title id="title-8812071124069258">Light theme icon (depiction of a sun)</title><path d="M7.5 11.465a3.482 3.482.0 01-1.596-.662L4.11 12.596a.5.5.0 01-.707-.707l1.793-1.793A3.482 3.482.0 014.535 8.5H2a.5.5.0 010-1h2.535a3.482 3.482.0 01.662-1.596L3.404 4.11a.5.5.0 01.707-.707l1.793 1.793A3.482 3.482.0 017.5 4.535V2a.5.5.0 011 0v2.535a3.482 3.482.0 011.596.662l1.793-1.793a.5.5.0 01.707.707l-1.793 1.793c.343.458.577 1.003.662 1.596H14a.5.5.0 110 1h-2.535a3.482 3.482.0 01-.662 1.596l1.793 1.793a.5.5.0 01-.707.707l-1.793-1.793a3.482 3.482.0 01-1.596.662V14a.5.5.0 11-1 0v-2.535z"/></svg></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--moon"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-5971296394189265" xmlns="http://www.w3.org/2000/svg"><title id="title-5971296394189265">Dark theme icon (depiction of a moon)</title><path d="M7.067 3.087a5 5 0 005.466 7.026A5 5 0 117.067 3.087z"/></svg></div></label><span class=Tooltip role=tooltip position=bottom-end>Set theme to dark (⇧+D)</span></div></div></div></div></div><main class=DocsBody><div class=DocsBody--sidebar with-styled-webkit-scrollbars><div class=DocsBody--sidebar-content-scroll-fade></div><div class=DocsBody--sidebar-content><ul class=DocsTableOfContents hidden><li><a class=DocsTableOfContents-link href=#docs-content>↑ Top</a></li></ul></nav></div></div><div id=docs-content data-reach-skip-nav-content></div><div class=DocsContent id=main page-type=document><article class=DocsMarkdown><h1 id=firewall-rules-faq>Firewall Rules FAQ</h1><h2 id=general><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#general>&#8203;​</a></span>
<span>General</span></h2><h3 id=how-many-rules-can-i-have-on-my-site><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#how-many-rules-can-i-have-on-my-site>&#8203;​</a></span>
<span>How many rules can I have on my site?</span></h3><p>You can create a large number of rules. However, the number of active rules at any given time is limited. Refer to <a href=/firewall/#availability class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Availability</span></a> for details on what is allowed per customer plan.</p><h3 id=can-i-purchase-additional-active-rules><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#can-i-purchase-additional-active-rules>&#8203;​</a></span>
<span>Can I purchase additional active rules?</span></h3><p>No. The number of active rules is fixed based on customer plan. Refer to <a href=/firewall/#availability class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Availability</span></a>.</p><h3 id=why-does-a-firewall-event-display-a-cloudflare-ip-address-even-though-other-fields-match-the-client-details><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#why-does-a-firewall-event-display-a-cloudflare-ip-address-even-though-other-fields-match-the-client-details>&#8203;​</a></span>
<span>Why does a firewall event display a Cloudflare IP address even though other fields match the client details?</span></h3><p>This happens when a request goes through a Cloudflare Worker.</p><p>In this case, Cloudflare considers the client details, including its IP address, for triggering security settings. However, the IP displayed in Security Events will be a Cloudflare IP address.</p><h2 id=rule-configuration><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#rule-configuration>&#8203;​</a></span>
<span>Rule configuration</span></h2><h3 id=how-are-certain-special-and-escaped-characters-handled><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#how-are-certain-special-and-escaped-characters-handled>&#8203;​</a></span>
<span>How are certain special and escaped characters handled?</span></h3><p>When used as literals in an expression, the backslash <code>\</code> and double quote <code>"</code> characters require proper escaping.</p><p>An expression built using the visual <a href=/firewall/cf-dashboard/edit-expressions/#expression-editor class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Expression Editor</span></a> does not require you to manually escape those special characters. Conveniently, the <a href=/firewall/cf-dashboard/edit-expressions/#expression-builder class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Expression Builder</span></a> takes care of any necessary escaping in the final expression by automatically prepending a backslash such that <code>\</code> and <code>"</code> become <code>\\</code> and <code>\"</code>, respectively.</p><p>The following image illustrates how double quotes are automatically escaped to <code>\"</code> once they appear in the plain text expression generated in the Expression Editor:</p><p><img src=/firewall/static/cf-firewall-rules-escaping.png alt="The Expression Editor displays rule values with special characters escaped using a backslash character"></p><h3 id=why-isnt-my-regular-expression-pattern-matching-working><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#why-isnt-my-regular-expression-pattern-matching-working>&#8203;​</a></span>
<span>Why isn&rsquo;t my regular expression pattern matching working?</span></h3><p>If you are using a regular expression, it is recommended that you test it with a tool like <a href="https://regex101.com/?flavor=golang" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Regular Expressions 101</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> or <a href=https://rustexp.lpil.uk class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Rustexp</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p>Also, note that the <code>http.request.method</code> field requires all-caps for method names (for example, <code>POST</code>).</p><h3 id=how-can-i-use-the-threat-score-effectively><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#how-can-i-use-the-threat-score-effectively>&#8203;​</a></span>
<span>How can I use the Threat Score effectively?</span></h3><p>The <em>Cloudflare Threat Score</em> is a key item behind the <strong>Security Level</strong> functionality in the Cloudflare dashboard.</p><p><em>Threat Score</em> as configured by <strong>Security Level</strong> is based on:</p><ul><li><em>High</em> - for scores greater than 0</li><li><em>Medium</em> - for scores greater than 14</li><li><em>Low</em> - for scores greater than 24</li><li><em>Essentially off</em> - for scores greater than 49</li></ul><p>Enabling a high threat score for sensitive areas, like comment form pages or login forms, can add an effective level of protection. Integrating <em>Threat Score</em> with firewall rules is advantageous because you can specify a CAPTCHA vs. a JS Challenge, or even a block. You can also exclude IP addresses using <em>and not</em> logic.</p><h3 id=how-do-i-create-an-exception-to-exclude-certain-requests-from-being-blocked-or-challenged><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#how-do-i-create-an-exception-to-exclude-certain-requests-from-being-blocked-or-challenged>&#8203;​</a></span>
<span>How do I create an exception to exclude certain requests from being blocked or challenged?</span></h3><p>There may be situations in which you want to enforce a blocking or challenging action but make exceptions for specific types of requests.</p><p>Cloudflare supports two methods to allow requests through firewall rules expressions:</p><ul><li>Exclude a type of request from being blocked or challenged, for example based on IP address, ASN, or country.</li><li>Create an independent firewall rule with an <em>Allow</em> action.</li></ul><aside class=DocsMarkdown--aside role=note data-type=note><div class=DocsMarkdown--aside-header>Note</div>Cloudflare Firewall Rules does not bypass other security measures configured under <strong>Security</strong>.</aside><p>If you wish to permit certain exclusions, the examples below illustrate a few possible approaches.</p><p><strong>Example 1</strong></p><p>Exclude multiple IP addresses from a blocking/challenging rule that assesses Threat Score.</p><div class=DocsMarkdown--table-wrap><div class=DocsMarkdown--table-wrap-inner><table style=width:100%><tbody><tr><td colspan=2><strong>Basic rule, with no <em>exclusion</em></strong></td></tr><tr><td>Action</td><td><em>Block</em> (or a challenge action)</td></tr><tr><td>Expression</td><td><code class=InlineCode>(http.host eq "example.com" and cf.threat_score > 5)</code></td></tr><tr><td colspan=2><strong>Rule that excludes IP addresses from being blocked/challenged</strong></td></tr><tr><td>Action</td><td><em>Block</em> (or a challenge action)</td></tr><tr><td>Expression</td><td><code class=InlineCode>(http.host eq "example.com" and cf.threat_score > 5) and not (ip.src in
{192.0.2.1 198.51.100.42 203.0.113.0/24})</code></td></tr><tr><td colspan=2><strong>Two rules to allow exceptions and block the rest</strong></td></tr><tr><td>Rule 1</td><td>Action: <em>Allow</em><br>Expression: <code class=InlineCode>ip.src in {192.0.2.1 198.51.100.42 203.0.113.0/24}</code></td></tr><tr><td>Rule 2</td><td>Action: <em>Block</em> (or a challenge action)<br><code class=InlineCode>(http.host eq "example.com" and cf.threat_score > 5)</code></td></tr></tbody></table></div></div><p><strong>Example 2</strong></p><p>Block Amazon Web Services (AWS) and Google Cloud Platform (GCP) because of large volumes of undesired traffic, but allow Googlebot and other known bots that Cloudflare validates.</p><div class=DocsMarkdown--table-wrap><div class=DocsMarkdown--table-wrap-inner><table style=width:100%><tbody><tr><td colspan=2><strong>Basic rule, with no <em>exclusion</em></strong></td></tr><tr><td>Action</td><td><em>Block</em> (or a challenge action)</td></tr><tr><td>Expression</td><td><code class=InlineCode>(ip.geoip.asnum in {16509 15169})</code></td></tr><tr><td colspan=2><strong>Rule that excludes known bots that Cloudflare validates</strong></td></tr><tr><td>Action</td><td><em>Block</em> (or a challenge action)</td></tr><tr><td>Expression</td><td><code class=InlineCode>(ip.geoip.asnum in {16509 15169} and not cf.client.bot)</code></td></tr><tr><td colspan=2><strong><strong>Two rules to allow exceptions and block the rest</strong></strong></td></tr><tr><td>Rule 1</td><td>Action: <em>Allow</em><br>Expression: <code class=InlineCode>cf.client.bot</code></td></tr><tr><td>Rule 2</td><td>Action: <em>Block</em> (or a challenge action)<br>Expression: <code class=InlineCode>(ip.geoip.asnum in {16509 15169})</code></td></tr></tbody></table></div></div><h2 id=bots><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#bots>&#8203;​</a></span>
<span>Bots</span></h2><h3 id=how-does-firewall-rules-handle-traffic-from-known-bots><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#how-does-firewall-rules-handle-traffic-from-known-bots>&#8203;​</a></span>
<span>How does Firewall Rules handle traffic from known bots?</span></h3><h4 id=caution-about-potentially-blocking-bots><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#caution-about-potentially-blocking-bots>&#8203;​</a></span>
<span>Caution about potentially blocking bots</span></h4><p>When you create a firewall rule with a <em>Block</em>, <em>Legacy CAPTCHA</em>, <em>JS Challenge</em>, or <em>Managed Challenge (Recommended)</em> action, you might unintentionally block traffic from known bots. Specifically, this might affect search engine optimization (SEO) and website monitoring when trying to enforce a mitigation action based on URI, path, host, ASN, or country.</p><p>Refer to <a href=#how-do-i-create-an-exception-to-exclude-certain-requests-from-being-blocked-or-challenged class=DocsMarkdown--link><span class=DocsMarkdown--link-content>How do I create an exception to exclude certain requests from being blocked or challenged?</span></a>.</p><h4 id=bots-currently-detected><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#bots-currently-detected>&#8203;​</a></span>
<span>Bots currently detected</span></h4><p><a href=https://radar.cloudflare.com/verified-bots class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Radar</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> lists a <strong>sample</strong> of known bots that Cloudflare Firewall Rules currently detects. When traffic comes from these bots and others not listed, the <code>cf.client.bot</code> field is set to true.</p><p>If you need to submit a friendly bot to be verified, use <a href="https://docs.google.com/forms/d/e/1FAIpQLSdqYNuULEypMnp4i5pROSc-uP6x65Xub9svD27mb8JChA_-XA/viewform?usp=sf_link" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>our online form</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><h2 id=challenges><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#challenges>&#8203;​</a></span>
<span>Challenges</span></h2><h3 id=do-the-challenge-actions-support-content-types-other-than-html-for-example-ajax-or-xhr-requests><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#do-the-challenge-actions-support-content-types-other-than-html-for-example-ajax-or-xhr-requests>&#8203;​</a></span>
<span>Do the Challenge actions support content types other than HTML (for example, AJAX or XHR requests)?</span></h3><p>No. The <em>Legacy CAPTCHA</em> and <em>JS Challenge</em> actions only support HTML requests.</p><p>Challenges presented to users display an intermediate page where they must prove they are not a bot. This concept does not work over XHR or AJAX.</p><p>When an XHR or AJAX request triggers one of the <em>Legacy CAPTCHA</em> actions, the resulting request will have the following status code:</p><ul><li>HTTP status code 403 for <em>Legacy CAPTCHA</em></li><li>HTTP status code 503 for <em>JS Challenge</em></li></ul><p>Your application can use these status codes to handle unexpected challenges.</p><h3 id=does-the-challengefailed-action-accurately-represent-challenges-that-users-did-not-pass><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#does-the-challengefailed-action-accurately-represent-challenges-that-users-did-not-pass>&#8203;​</a></span>
<span>Does the &lsquo;challengeFailed&rsquo; action accurately represent challenges that users did not pass?</span></h3><p>No. The <code>challengeFailed</code> and <code>jschallengeFailed</code> firewall rule actions account for observed requests that, under special circumstances, did not pass a challenge. However, some failed challenges cannot be traced back to a firewall rule. Additionally, Cloudflare Firewall Rules may not have a record of every request with a failed challenge.</p><p>Therefore, consider these actions with caution. A reliable indicator is the <a href=/bots/concepts/challenge-solve-rate/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Challenge Solve Rate (CSR)</span></a> displayed in <strong>Security</strong> > <strong>WAF</strong> > <strong>Firewall rules</strong>, which is calculated as follows: <code>number of challenges solved / number of challenges issued</code>.</p><h3 id=why-would-i-not-find-any-failed-challenges-why-is-challengeissued-not-equal-to-challengesolved-plus-challengefailed><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#why-would-i-not-find-any-failed-challenges-why-is-challengeissued-not-equal-to-challengesolved-plus-challengefailed>&#8203;​</a></span>
<span>Why would I not find any failed challenges? Why is &lsquo;ChallengeIssued&rsquo; not equal to &lsquo;ChallengeSolved&rsquo; plus &lsquo;ChallengeFailed&rsquo;?</span></h3><p>Users do not complete all challenges. Cloudflare issues challenges that are never answered — only 2-3% of all served challenges are usually answered.</p><p>There are multiple reasons for this:</p><ul><li>Users give up on a challenge.</li><li>Users try to solve a challenge but cannot provide an answer.</li><li>Users keep refreshing the challenge but never submit an answer.</li><li>Users keep retrying hCaptcha (CAPTCHA failures in hCaptcha are not registered as failed and represent interim failures).</li><li>Cloudflare receives a malformed challenge answer.</li></ul><h3 id=why-do-i-have-matches-for-a-firewall-rule-that-was-not-supposed-to-match-the-request><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#why-do-i-have-matches-for-a-firewall-rule-that-was-not-supposed-to-match-the-request>&#8203;​</a></span>
<span>Why do I have matches for a firewall rule that was not supposed to match the request?</span></h3><p>Make sure you are looking at the correct request.</p><p>Only requests that triggered a challenge will match the request parameters of the rule. Subsequent requests with a <code>[js]challengeSolved</code> or <code>[js]challengeFailed</code> action may not match the parameters of the rule — for example, the bot score may have changed because the user solved a CAPTCHA.</p><p>The &ldquo;solved&rdquo; and &ldquo;failed&rdquo; actions are informative actions about a previous request that matched a rule. These actions state that &ldquo;previously a rule had matched a request with the action set to <em>Legacy CAPTCHA</em> or <em>JS Challenge</em> and now that challenge was answered.&rdquo;</p></article></div></main><footer class=DocsFooter><div class=DocsFooter--content><div class=DocsFooterResources><span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/:zone/security/waf/firewall-rules" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Dashboard</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://community.cloudflare.com/c/security/6 class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Community</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://www.cloudflare.com/learning/ddos/glossary/web-application-firewall-waf/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Learning Center</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/support" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Support Portal</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span></div><div><span class=DocsFooter--edit-on-gh-link-wrapper><a href=https://github.com/panthere2k/cf-docs/blob/main/content/firewall/known-issues-and-faq/index.md class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Edit on GitHub</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-time>Updated <time class=relative datetime=2023-01-02T09:58:19+09:00 title=2023-01-02>January 2, 2023</time></span></div></div></footer></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKQFGQB" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PKQFGQB")</script><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style></noscript><script defer src=https://unpkg.com/littlefoot/dist/littlefoot.js type=application/javascript></script>
<script type=application/javascript>document.addEventListener("DOMContentLoaded",()=>littlefoot.default())</script></body></html>