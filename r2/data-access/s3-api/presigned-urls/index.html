<!doctype html><html lang=en theme=light is-docs-page js-focus-visible-polyfill-available><head><meta charset=utf-8><title>Presigned URLs · Cloudflare R2 docs</title><meta http-equiv=cleartype content="on"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=application-name content="Presigned URLs · Cloudflare R2 docs"><meta name=msapplication-tap-highlight content="no"><meta name=apple-mobile-web-app-title content="Presigned URLs · Cloudflare R2 docs"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-capable content="yes"><meta name=mobile-web-app-capable content="yes"><meta name=theme-color content="#f38020"><meta name=description content="Store large amounts of unstructured data without egress fees."><meta property="og:image" content="https://panthere2k.github.io/dev-products-preview.png"><meta property="og:title" content="Presigned URLs · Cloudflare R2 docs"><meta property="og:description" content="Store large amounts of unstructured data without egress fees."><meta property="og:type" content="website"><meta name=twitter:title content="Presigned URLs · Cloudflare R2 docs"><meta name=twitter:image content="https://panthere2k.github.io/dev-products-preview.png"><meta name=twitter:description content="Store large amounts of unstructured data without egress fees."><meta name=twitter:creator content="@cloudflare"><meta name=twitter:card content="summary_large_image"><meta name=pcx_content_type content="concept"><link rel=icon href=/favicon-32x32.png><link rel=canonical href=https://panthere2k.github.io/r2/data-access/s3-api/presigned-urls/><link rel=sitemap href=/sitemap.xml type=application/xml><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon sizes=48x48 href=/icons/icon-48x48.png><link rel=apple-touch-icon sizes=72x72 href=/icons/icon-72x72.png><link rel=apple-touch-icon sizes=96x96 href=/icons/icon-96x96.png><link rel=apple-touch-icon sizes=144x144 href=/icons/icon-144x144.png><link rel=apple-touch-icon sizes=192x192 href=/icons/icon-192x192.png><link rel=apple-touch-icon sizes=256x256 href=/icons/icon-256x256.png><link rel=apple-touch-icon sizes=384x384 href=/icons/icon-384x384.png><link rel=apple-touch-icon sizes=512x512 href=/icons/icon-512x512.png><script src=/search.redirect.min.6828ce878577fe91120d67814d68c0d8.js defer></script><link rel="stylesheet preconnect" href=/style.css><script>(function(){let s=!1,e,n;document.readyState!=="loading"?o():addEventListener("DOMContentLoaded",o),e=document.querySelector("#ThemeToggle"),s=!e;function t(n){try{let o=n?"dark":"light";document.documentElement.setAttribute("theme",o),localStorage.theme=JSON.stringify({theme:o}),e?(e.checked=n,s=!1):s&&setTimeout(t,1,n)}catch{}}function o(){e=e||document.querySelector("#ThemeToggle"),e.addEventListener("change",()=>t(!!e.checked)),addEventListener("keydown",n=>{n.target===document.body&&n.which===68&&n.shiftKey&&(n.preventDefault(),t(!e.checked))})}try{n=window.matchMedia("(prefers-color-scheme:dark)"),n.onchange=e=>t(e.matches)}catch{}try{let e=localStorage.theme,s=e&&JSON.parse(e);t(s?/dark/.test(s.theme):!!(n&&n.matches))}catch{}})()</script><script src=/main.min.c2a5e976c412695a3d9389cba84aa5bd.js defer></script>
<script data-source=docs defer src=https://feedback.developers.cloudflare.com/sdk.js></script>
<link rel=preload href=https://feedback.developers.cloudflare.com/sdk.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://feedback.developers.cloudflare.com/sdk.css></noscript></head><body><div class=DocsPage><div><a class=skip-link href=#main>Skip to content</a></div><div class=DocsMobileHeader><a class="DocsMobileHeader--cloudflare-logo-link Link Link-without-underline" href=/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsMobileTitleHeader><a aria-current=page class="DocsMobileTitleHeader--logo-link Link Link-without-underline" href=/r2/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><span title="Cloudflare R2 logo"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><path fill-rule="evenodd" d="M30.289 6.423c-2.43-.813-5.958-1.362-9.977-1.362-4.018.0-7.545.549-9.976 1.362-1.228.41-2.033.842-2.48 1.195-.094.074-.16.134-.204.18.052.171.196.395.562.67.524.394 1.372.783 2.563 1.119 2.368.666 5.731 1.023 9.536 1.023 3.804.0 7.167-.357 9.535-1.023 1.191-.336 2.04-.725 2.563-1.119.366-.275.51-.499.562-.67a2.211 2.211.0 00-.204-.18c-.447-.353-1.252-.784-2.48-1.195zm-20.24 5.624c-.885-.25-1.71-.552-2.424-.922v4.393c0 .196.097.514.625.941.535.433 1.391.869 2.576 1.252 2.36.764 5.71 1.222 9.486 1.222 3.778.0 7.128-.458 9.487-1.222 1.185-.383 2.041-.82 2.576-1.252.528-.427.625-.745.625-.94v-4.394c-.715.37-1.539.673-2.424.922-2.7.76-6.336 1.124-10.264 1.124-3.927.0-7.564-.364-10.263-1.124zm25.576 3.471V7.622c0-2.829-6.856-5.122-15.313-5.122C11.857 2.5 5 4.793 5 7.622v24.756c0 2.829 6.856 5.122 15.313 5.122 8.456.0 15.312-2.293 15.312-5.122v-16.86zM33 19.134c-.7.393-1.505.726-2.375 1.008-2.708.877-6.358 1.352-10.313 1.352-3.954.0-7.604-.475-10.312-1.352-.87-.282-1.676-.615-2.375-1.008v4.28c0 .196.097.514.625.942.535.432 1.391.868 2.576 1.252 2.36.763 5.71 1.221 9.486 1.221 3.778.0 7.128-.458 9.487-1.221 1.185-.384 2.041-.82 2.576-1.252.528-.428.625-.746.625-.941v-4.28zm-23 8.904c-.87-.281-1.676-.615-2.375-1.007v5.143c.044.048.116.117.231.208.447.353 1.252.785 2.48 1.195 2.43.813 5.958 1.362 9.976 1.362 4.019.0 7.546-.549 9.977-1.362 1.228-.41 2.033-.842 2.48-1.195a2.03 2.03.0 00.231-.208v-5.143c-.7.392-1.505.726-2.375 1.007-2.708.877-6.358 1.352-10.313 1.352-3.954.0-7.604-.475-10.312-1.352zm23.06 4.06-.01.016a.059.059.0 01.01-.016zm-25.495.0.01.016a.06.06.0 01-.01-.016zm3.997-15.726c.725.0 1.313-.573 1.313-1.28.0-.708-.588-1.281-1.313-1.281-.724.0-1.312.573-1.312 1.28.0.708.588 1.281 1.313 1.281zm1.313 6.83c0 .706-.588 1.28-1.313 1.28-.724.0-1.312-.574-1.312-1.28.0-.708.588-1.281 1.313-1.281.724.0 1.312.573 1.312 1.28zm-1.313 9.176c.725.0 1.313-.573 1.313-1.28.0-.708-.588-1.28-1.313-1.28-.724.0-1.312.572-1.312 1.28.0.707.588 1.28 1.313 1.28z" clip-rule="evenodd"/></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:2>R2</span></span></div></a><button class="Button DocsMobileTitleHeader--sidebar-toggle-button">
<span class=DocsMobileTitleHeader--sidebar-toggle-button-icon aria-hidden=true><svg viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="title-1332672649688018" xmlns="http://www.w3.org/2000/svg"><title id="title-1332672649688018">Navigation menu icon</title><path data-index="1" d="M5 7h10" transform-origin="10 7"/><path data-index="2" d="M5 10h10" transform-origin="10 10"/><path data-index="3" d="M5 13h10" transform-origin="10 13"/></svg><span is-visually-hidden>Open external link</span></span></button></div><div class=DocsMobileNavBackdrop></div><div class=DocsSidebar><div class=DocsSidebar--sections><div class="DocsSidebar--section DocsSidebar--header-section"><a class="DocsSidebar--cloudflare-logo-link DocsSidebar--link" href=/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsSidebar--section-separator></div><div class="DocsSidebar--section DocsSidebar--docs-title-section"><a aria-current=page class="DocsSidebar--docs-title-logo-link DocsSidebar--link" href=/r2/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><span title="Cloudflare R2 logo"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><path fill-rule="evenodd" d="M30.289 6.423c-2.43-.813-5.958-1.362-9.977-1.362-4.018.0-7.545.549-9.976 1.362-1.228.41-2.033.842-2.48 1.195-.094.074-.16.134-.204.18.052.171.196.395.562.67.524.394 1.372.783 2.563 1.119 2.368.666 5.731 1.023 9.536 1.023 3.804.0 7.167-.357 9.535-1.023 1.191-.336 2.04-.725 2.563-1.119.366-.275.51-.499.562-.67a2.211 2.211.0 00-.204-.18c-.447-.353-1.252-.784-2.48-1.195zm-20.24 5.624c-.885-.25-1.71-.552-2.424-.922v4.393c0 .196.097.514.625.941.535.433 1.391.869 2.576 1.252 2.36.764 5.71 1.222 9.486 1.222 3.778.0 7.128-.458 9.487-1.222 1.185-.383 2.041-.82 2.576-1.252.528-.427.625-.745.625-.94v-4.394c-.715.37-1.539.673-2.424.922-2.7.76-6.336 1.124-10.264 1.124-3.927.0-7.564-.364-10.263-1.124zm25.576 3.471V7.622c0-2.829-6.856-5.122-15.313-5.122C11.857 2.5 5 4.793 5 7.622v24.756c0 2.829 6.856 5.122 15.313 5.122 8.456.0 15.312-2.293 15.312-5.122v-16.86zM33 19.134c-.7.393-1.505.726-2.375 1.008-2.708.877-6.358 1.352-10.313 1.352-3.954.0-7.604-.475-10.312-1.352-.87-.282-1.676-.615-2.375-1.008v4.28c0 .196.097.514.625.942.535.432 1.391.868 2.576 1.252 2.36.763 5.71 1.221 9.486 1.221 3.778.0 7.128-.458 9.487-1.221 1.185-.384 2.041-.82 2.576-1.252.528-.428.625-.746.625-.941v-4.28zm-23 8.904c-.87-.281-1.676-.615-2.375-1.007v5.143c.044.048.116.117.231.208.447.353 1.252.785 2.48 1.195 2.43.813 5.958 1.362 9.976 1.362 4.019.0 7.546-.549 9.977-1.362 1.228-.41 2.033-.842 2.48-1.195a2.03 2.03.0 00.231-.208v-5.143c-.7.392-1.505.726-2.375 1.007-2.708.877-6.358 1.352-10.313 1.352-3.954.0-7.604-.475-10.312-1.352zm23.06 4.06-.01.016a.059.059.0 01.01-.016zm-25.495.0.01.016a.06.06.0 01-.01-.016zm3.997-15.726c.725.0 1.313-.573 1.313-1.28.0-.708-.588-1.281-1.313-1.281-.724.0-1.312.573-1.312 1.28.0.708.588 1.281 1.313 1.281zm1.313 6.83c0 .706-.588 1.28-1.313 1.28-.724.0-1.312-.574-1.312-1.28.0-.708.588-1.281 1.313-1.281.724.0 1.312.573 1.312 1.28zm-1.313 9.176c.725.0 1.313-.573 1.313-1.28.0-.708-.588-1.28-1.313-1.28-.724.0-1.312.572-1.312 1.28.0.707.588 1.28 1.313 1.28z" clip-rule="evenodd"/></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:2>R2</span></span></div></a><div class="DocsSidebar--section-more Dropdown" data-expanded=false><button class="DocsSidebar--section-more-button Button" aria-expanded=false><div class=DocsSidebar--section-more-button-icon><svg viewBox="0 0 4 16" stroke="currentcolor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" fill="currentcolor" role="img" aria-labelledby="title-6032186738345315" xmlns="http://www.w3.org/2000/svg"><title id="title-6032186738345315">Dropdown icon</title><path d="M2 2v0m0 6v0m0 6v0z"/></svg><span is-visually-hidden>R2 menu</span></div></button><div class="DocsSidebar--section-more-dropdown Dropdown--dropdown"><ul class=Dropdown--list><li class=Dropdown--item><a class=Dropdown--link href=https://cloudflare.com tabindex=-1>Cloudflare homepage</a></li></ul></div></div></div><div class="DocsSidebar--section DocsSidebar--nav-section" style=position:relative;overflow:hidden;width:100%;height:100%><div style=position:absolute;inset:0;overflow-y:auto;margin-right:0;margin-bottom:0><div class=DocsSidebar--nav-section-shadow style=opacity:0></div><ul class=DocsSidebar--nav><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Overview</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/get-started/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Get started</span></a></li><li class=DocsSidebar--nav-item is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Data Access</span>
</button><a class=DocsSidebar--nav-link href=/r2/data-access/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Data Access</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style=min-height:0;transition-duration:400ms is-expanded><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Workers API</span>
</button><a class=DocsSidebar--nav-link href=/r2/data-access/workers-api/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Workers API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/workers-api/workers-api-usage/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Use R2 from Workers</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/workers-api/workers-multipart-usage/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Use the R2 multipart API from Workers</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/workers-api/workers-api-reference/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Workers API Reference</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: S3 API</span>
</button><a class=DocsSidebar--nav-link href=/r2/data-access/s3-api/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>S3 API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style=min-height:0;transition-duration:400ms is-expanded><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/s3-api/api/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>S3 API Compatibility</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/s3-api/extensions/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Extensions</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/s3-api/tokens/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Generate an S3 Auth token</span></a></li><li class=DocsSidebar--nav-item is-active><a aria-current=page class=DocsSidebar--nav-link href=/r2/data-access/s3-api/presigned-urls/ is-active><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Presigned URLs</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/data-access/public-buckets/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Public Buckets</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Learning</span>
</button><a class=DocsSidebar--nav-link href=/r2/learning/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Learning</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/learning/unicode-interoperability/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Filename encoding and interoperability problems</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Platform</span>
</button><a class=DocsSidebar--nav-link href=/r2/platform/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Platform</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/platform/pricing/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Pricing</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/platform/limits/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Limits</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/platform/changelog/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Changelog</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/r2/examples/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Examples</span></a></li></ul></div><div style=position:absolute;height:6px;display:none;right:2px;bottom:2px;left:2px;border-radius:3px><div style=position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)></div></div><div style=position:absolute;width:6px;display:none class="Scrollbars--track Scrollbars--track-vertical"><div style=position:relative;display:block;width:100% class="Scrollbars--thumb Scrollbars--thumb-vertical"></div></div></div><div class=toggleSidebar><button id=toggleSidebarButton style=width:2em;height:2em title="Click to collapse and expand the sidebar navigation"><svg id="toggleSidebarSVG" aria-hidden="true" height="1" width="1" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path id="toggleSidebarSVGPath" d="M15 2a1 1 0 00-1 1v10a1 1 0 002 0V3a1 1 0 00-1-1zm-10.407.993-4.3 4.3a1 1 0 000 1.414l4.3 4.3a1 1 0 001.415-1.416L3.417 9H10a1 1 0 100-2H3.417l2.591-2.591A1 1 0 104.593 2.993z"/></svg></button></div></div><div class=DocsSidebar--shadow></div></div><div class=DocsToolbar><div class=DocsToolbar--search><div class=DocsSearch><div class=DocsSearch--input-wrapper><input type=text id=DocsSearch--input class=DocsSearch--input spellcheck=false autocomplete=false placeholder="Search docs..."><div class=DocsSearch--input-icon><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-9701125841014673" xmlns="http://www.w3.org/2000/svg"><title id="title-9701125841014673">Search icon (depiction of a magnifying glass)</title><path d="M11.999 10.585l3.458 3.458a1 1 0 01-1.414 1.414L10.585 12a6.5 6.5.0 111.414-1.414zM6.75 11.5a4.75 4.75.0 100-9.5 4.75 4.75.0 000 9.5z"/></svg></div><button disabled class=slashPlaceholder title="Press '/' to focus on the search bar" aria-label="Forward slash keyboard shortcut" tabindex=-1 type=button><div style=margin-top:-1px>/</span></div></button></div></div></div><div class=DocsToolbar--tools><button data-feedback=true class="DocsToolbar--feedback Button Button-is-docs-secondary">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17"><path d="M14 2.5H2l-.5.5v11.165l.863.345 2.852-3.01H14l.5-.5V3l-.5-.5zm-.5 8H4.785L2.5 12.911V3.5h11v7z" fill="currentcolor"/><path d="M12.5 5.003h-9v1h9v-1zm0 2.497h-9v1h9v-1z" fill="currentcolor"/></svg>Give Feedback</button><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--tools-icon-item><div class=Tooltip---root><div class=DocsToolbar--tools-icon-item-content><a class="Link Link-without-underline" href=https://github.com/cloudflare/cloudflare-docs><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-6991762763429039" xmlns="http://www.w3.org/2000/svg"><title id="title-6991762763429039">GitHub icon</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"/></svg></a></div><span class=Tooltip role=tooltip position=bottom-end>Visit R2 on GitHub</span></div></div><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--theme-toggle><div class=Tooltip---root><div class=ThemeToggle><input type=checkbox id=ThemeToggle class=ThemeToggle--input>
<label class=ThemeToggle--toggle for=ThemeToggle><div class=ThemeToggle--toggle-handle></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--sun"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-8812071124069258" xmlns="http://www.w3.org/2000/svg"><title id="title-8812071124069258">Light theme icon (depiction of a sun)</title><path d="M7.5 11.465a3.482 3.482.0 01-1.596-.662L4.11 12.596a.5.5.0 01-.707-.707l1.793-1.793A3.482 3.482.0 014.535 8.5H2a.5.5.0 010-1h2.535a3.482 3.482.0 01.662-1.596L3.404 4.11a.5.5.0 01.707-.707l1.793 1.793A3.482 3.482.0 017.5 4.535V2a.5.5.0 011 0v2.535a3.482 3.482.0 011.596.662l1.793-1.793a.5.5.0 01.707.707l-1.793 1.793c.343.458.577 1.003.662 1.596H14a.5.5.0 110 1h-2.535a3.482 3.482.0 01-.662 1.596l1.793 1.793a.5.5.0 01-.707.707l-1.793-1.793a3.482 3.482.0 01-1.596.662V14a.5.5.0 11-1 0v-2.535z"/></svg></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--moon"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-5971296394189265" xmlns="http://www.w3.org/2000/svg"><title id="title-5971296394189265">Dark theme icon (depiction of a moon)</title><path d="M7.067 3.087a5 5 0 005.466 7.026A5 5 0 117.067 3.087z"/></svg></div></label><span class=Tooltip role=tooltip position=bottom-end>Set theme to dark (⇧+D)</span></div></div></div></div></div><main class=DocsBody><div class=DocsBody--sidebar with-styled-webkit-scrollbars><div class=DocsBody--sidebar-content-scroll-fade></div><div class=DocsBody--sidebar-content><ul class=DocsTableOfContents hidden><li><a class=DocsTableOfContents-link href=#docs-content>↑ Top</a></li></ul></nav></div></div><div id=docs-content data-reach-skip-nav-content></div><div class=DocsContent id=main page-type=document><article class=DocsMarkdown><h1 id=presigned-urls>Presigned URLs</h1><p>Presigned URLs are an <a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-presigned-url.html class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>S3 concept</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> for sharing direct access to your bucket without revealing your token secret. A presigned URL authorizes anyone with the URL to perform an action to the S3 compatibility endpoint for an R2 bucket. By default, the S3 endpoint requires an <code>AUTHORIZATION</code> header signed by your token. Every presigned URL has S3 parameters and search parameters containing the signature information that would be present in an <code>AUTHORIZATION</code> header. The performable action is restricted to a specific resource, an <a href=/r2/data-access/s3-api/api/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>operation</span></a>, and has an associated timeout.</p><p>There are three kinds of resources in R2:</p><ol><li><strong>Account</strong>: For account-level operations (such as <code>CreateBucket</code>, <code>ListBuckets</code>, <code>DeleteBucket</code>) the identifier is the account ID.</li><li><strong>Bucket</strong>: For bucket-level operations (such as <code>ListObjects</code>, <code>PutBucketCors</code>) the identifier is the account ID, and bucket name.</li><li><strong>Object</strong>: For object-level operations (such as <code>GetObject</code>, <code>PutObject</code>, <code>CreateMultipartUpload</code>) the identifier is the account ID, bucket name, and object path.</li></ol><p>All parts of the identifier are part of the presigned URL.</p><p>You cannot change the resource being accessed after the request is signed. For example, trying to change the bucket name to access the same object in a different bucket will return a <code>403</code> with an error code of <code>SignatureDoesNotMatch</code>.</p><p>Presigned URLs must have a defined expiry. You can set a timeout from one second to 7 days (604,800 seconds) into the future. The URL will contain the time when the URL was generated (<code>X-Amz-Date</code>) and the timeout (<code>X-Amz-Expires</code>) as search parameters. These search parameters are signed and tampering with them will result in <code>403</code> with an error code of <code>SignatureDoesNotMatch</code>.</p><p>Presigned URLs are generated with no communication with R2 and must be generated by an application with access to your R2 bucket&rsquo;s credentials.</p><h2 id=presigned-url-use-cases><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#presigned-url-use-cases>&#8203;​</a></span>
<span>Presigned URL use cases</span></h2><p>There are three ways to grant an application access to R2:</p><ol><li>The application has its own copy of an <a href=/r2/data-access/s3-api/tokens/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>R2 API token</span></a>.</li><li>The application requests a copy of an R2 API token from a vault application and promises to not permanently store that token locally.</li><li>The application requests a central application to give it a presigned URL it can use to perform an action.</li></ol><p>In scenarios 1 and 2, if the application or vault application is compromised, the holder of the token can perform arbitrary actions.</p><p>Scenario 3 keeps the credential secret. If the application making a presigned URL request to the central application leaks that URL, but the central application does not have its key storage system compromised, the impact is limited to one operation on the specific resource that was signed.</p><p>Additionally, the central application can perform monitoring, auditing, logging tasks so you can review when a request was made to perform an operation on a specific resource. In the event of a security incident, you can use a central application&rsquo;s logging functionality to review details of the incident.</p><p>The central application can also perform policy enforcement. For example, if you have an application responsible for uploading resources, you can restrict the upload to a specific bucket or folder within a bucket. The requesting application can obtain a JSON Web Token (JWT) from your authorization service to sign a request to the central application. The central application then uses the information contained in the JWT to validate the inbound request parameters.</p><p>The central application can be, for example, a Cloudflare Worker. Worker secrets are cryptographically impossible to obtain outside of your script running on the Workers runtime. If you do not store a copy of the secret elsewhere and do not have your code log the secret somewhere, your Worker secret will remain secure. However, as previously mentioned, presigned URLs are generated outside of R2 and all that&rsquo;s required is the secret + an implementation of the signing algorithm, so you can generate them anywhere.</p><p>Another potential use case for presigned URLs is debugging. For example, if you are debugging your application and want to grant temporary access to a specific test object in a production environment, you can do this without needing to share the underlying token and remembering to revoke it.</p><h2 id=generate-presigned-urls><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#generate-presigned-urls>&#8203;​</a></span>
<span>Generate presigned URLs</span></h2><p>Generate a presigned URL by referring to the following examples:</p><ul><li><a href=/r2/examples/aws-sdk-go/#generate-presigned-urls class=DocsMarkdown--link><span class=DocsMarkdown--link-content>AWS SDK for Go</span></a></li><li><a href=/r2/examples/aws-sdk-js-v3/#generate-presigned-urls class=DocsMarkdown--link><span class=DocsMarkdown--link-content>AWS SDK for JS v3</span></a></li><li><a href=/r2/examples/aws-sdk-js/#generate-presigned-urls class=DocsMarkdown--link><span class=DocsMarkdown--link-content>AWS SDK for JS</span></a></li><li><a href=/r2/examples/aws-sdk-php/#generate-presigned-urls class=DocsMarkdown--link><span class=DocsMarkdown--link-content>AWS SDK for PHP</span></a></li><li><a href=/r2/examples/aws-cli/#generate-presigned-urls class=DocsMarkdown--link><span class=DocsMarkdown--link-content>AWS CLI</span></a></li></ul><h2 id=presigned-url-alternative-with-workers><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#presigned-url-alternative-with-workers>&#8203;​</a></span>
<span>Presigned URL alternative with Workers</span></h2><p>A valid alternative design to presigned URLs is to use a Worker with a <a href=/workers/platform/bindings/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>binding</span></a> that implements your security policy.</p><aside class=DocsMarkdown--aside role=note data-type=note><div class=DocsMarkdown--aside-header>Bindings</div><p>A binding is a how your Worker interacts with external resources such as <a href=/workers/runtime-apis/kv/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>KV Namespaces</span></a>, <a href=/workers/runtime-apis/durable-objects/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Durable Objects</span></a>, or <a href=#api class=DocsMarkdown--link><span class=DocsMarkdown--link-content>R2 Buckets</span></a>. A binding is a runtime variable that the Workers runtime provides to your code. You can declare a variable name in your <code>wrangler.toml</code> file that will be bound to these resources at runtime, and interact with them through this variable. Every binding&rsquo;s variable name and behavior is determined by you when deploying the Worker. Refer to <a href=/workers/platform/environment-variables class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Environment Variables</span></a> for more information.</p><p>A binding is defined in the <code>wrangler.toml</code> file of your Worker project&rsquo;s directory.</p></aside><p>A possible use case may be restricting an application to only be able to upload to a specific URL. With presigned URLs, your central signing application might look like the following JavaScript code running on Cloudflare Workers, workerd, or another platform:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>AwsClient</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;aws4fetch&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>r2</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AwsClient</span><span class=p>({</span>
</span></span><span class=line><span class=cl>	<span class=nx>accessKeyId</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>secretAccessKey</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>service</span><span class=o>:</span> <span class=s1>&#39;s3&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>region</span><span class=o>:</span> <span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>&lt;</span><span class=nt>ExportedHandler</span><span class=p>&gt;{</span>
</span></span><span class=line><span class=cl>	<span class=kr>async</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kr>const</span> <span class=nx>authorization</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>authorize</span><span class=p>(</span><span class=nx>request</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// `authorize` is not provided in the Worker
</span></span></span><span class=line><span class=cl><span class=c1>// It is best practice to add some form of authorization to protect your bucket from abuse, such as a preshared secret in a header
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>if</span> <span class=p>(</span><span class=nx>authorization</span> <span class=o>===</span> <span class=kc>undefined</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;invalid authorization&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>401</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>authorization</span><span class=p>.</span><span class=nx>application</span> <span class=o>===</span> <span class=s1>&#39;drop-box&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>// Check that the application is only requesting a URL
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;/my-upload-folder/&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;invalid destination folder&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>403</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=kr>const</span> <span class=nx>signedUrl</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>r2</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>				<span class=k>new</span> <span class=nx>Request</span><span class=p>(</span>
</span></span><span class=line><span class=cl>					<span class=sb>`https://&lt;DROPBOX BUCKET&gt;.&lt;ACCOUNT ID&gt;.r2.cloudflarestorage.com</span><span class=si>${</span><span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;PUT&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>aws</span><span class=o>:</span> <span class=p>{</span> <span class=nx>signQuery</span>: <span class=kt>true</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>					<span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=c1>// The signed request is valid for 1 hour.
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=s1>&#39;X-Amz-Expires&#39;</span><span class=o>:</span> <span class=mi>3600</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=p>},</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>// Caller can now use this URL to upload to that object.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>signedUrl</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>200</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>// ... handle other kinds of requests
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>An equivalent Cloudflare Worker would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>Env</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>DROP_BOX_BUCKET</span>: <span class=kt>R2Bucket</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>&lt;</span><span class=nt>ExportedHandler</span><span class=err>&lt;</span><span class=na>Env</span><span class=p>&gt;</span><span class=o>&gt;</span><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kr>async</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>env</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kr>const</span> <span class=nx>authorization</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>authorize</span><span class=p>(</span><span class=nx>request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>authorization</span> <span class=o>===</span> <span class=kc>undefined</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;invalid authorization&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>401</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>authorization</span><span class=p>.</span><span class=nx>application</span> <span class=o>===</span> <span class=s1>&#39;drop-box&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>// Check that the application is only requesting a URL
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;/my-upload-folder/&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;invalid destination folder&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>403</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=k>await</span> <span class=nx>env</span><span class=p>.</span><span class=nx>DROP_BOX_BUCKET</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>toString</span><span class=p>().</span><span class=nx>substring</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=nx>request</span><span class=p>.</span><span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>200</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//  ... handle other kinds of requests
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>Notice the total absence of any configuration or token secrets present in the Worker code. Instead, you would create a <code>wrangler.toml</code> <a href=/r2/data-access/workers-api/workers-api-usage/#4-bind-your-bucket-to-a-worker class=DocsMarkdown--link><span class=DocsMarkdown--link-content>binding</span></a> to whatever bucket represents the bucket you will upload to. Additionally, authorization is handled in-line with the upload which can reduce latency.</p><p>In some cases, Workers lets you implement certain functionality more easily. For example, if you wanted to offer a write-once guarantee so that users can only upload to a path once, with pre-signed URLs, you would need to sign specific headers and require the sender to send them. This adds some complexity:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>const</span> <span class=nx>signedUrl</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>r2</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=k>new</span> <span class=nx>Request</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=sb>`https://&lt;DROPBOX BUCKET&gt;.&lt;ACCOUNT ID&gt;.r2.cloudflarestorage.com</span><span class=si>${</span><span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;PUT&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>aws</span><span class=o>:</span> <span class=p>{</span> <span class=nx>signQuery</span>: <span class=kt>true</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// The signed request is valid for 1 hour.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=s1>&#39;X-Amz-Expires&#39;</span><span class=o>:</span> <span class=mi>3600</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=s1>&#39;If-Unmodified-Since&#39;</span><span class=o>:</span> <span class=s1>&#39;Tue, 28 Sep 2021 16:00:00 GMT&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p>Note that the caller has to add the the same <code>If-Unmodified-Since</code> header to use the URL. The caller cannot omit the header or use a different header. If the caller uses a different header, the presigned URL signature would not match and they would receive a <code>403/SignatureDoesNotMatch</code>.</p><p>In a Worker, you would change your upload to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>const</span> <span class=nx>existingObject</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>env</span><span class=p>.</span><span class=nx>DROP_BOX_BUCKET</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>url</span><span class=p>.</span><span class=nx>toString</span><span class=p>().</span><span class=nx>substring</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=nx>request</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>onlyIf</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// No objects will have been uploaded before September 28th, 2021 which
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=c1>// is the initial R2 announcement.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>uploadedBefore</span>: <span class=kt>new</span> <span class=nb>Date</span><span class=p>(</span><span class=mi>1632844800000</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>existingObject</span><span class=o>?</span><span class=p>.</span><span class=nx>etag</span> <span class=o>!==</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s1>&#39;etag&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;attempt to overwrite object&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span>: <span class=kt>400</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Cloudflare Workers currently have some limitations that you may need to consider:</p><ul><li>You cannot upload more than 100 MiB (200 MiB for Business customers) to a Worker.</li><li>Enterprise customers can upload 500 MiB by default and can ask their account team to raise this limit.</li><li>Detecting <a href=/r2/data-access/s3-api/extensions/#conditional-operations-in-putobject class=DocsMarkdown--link><span class=DocsMarkdown--link-content>precondition failures</span></a> is currently easier with presigned URLs as compared with R2 bindings.</li></ul><p>Note that these limitations depends on R2&rsquo;s extension for conditional uploads. Amazon&rsquo;s S3 service does not offer such functionality at this time.</p><h2 id=differences-between-presigned-urls-and-public-buckets><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#differences-between-presigned-urls-and-public-buckets>&#8203;​</a></span>
<span>Differences between presigned URLs and public buckets</span></h2><p>Presigned URLs share some superificial similarity with public buckets. If you give out presigned URLs only for <code>GET</code>/<code>HEAD</code> operations on specific objects in a bucket, then your presigned URL functionality is mostly similar to public buckets. The notable exception is that any custom metadata associated with the object is rendered in headers with the <code>x-amz-meta-</code> prefix. Any error responses are returned as XML documents, as they would with normal non-presigned S3 access.</p><p>Presigned URLs can be generated for any S3 operation. After a presigned URL is generated it can be reused as many times as the holder of the URL wants until the signed expiry date.</p><p><a href=/r2/data-access/public-buckets/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Public buckets</span></a> are available on a regular HTTP endpoint. By default, there is no authorization or access controls associated with a public bucket. Anyone with a public bucket URL can access an object in that public bucket. If you are using a custom domain to expose the R2 bucket, you can manage authorization and access controls as you would for a Cloudflare zone. Public buckets only provide <code>GET</code>/<code>HEAD</code> on a known object path. Public bucket errors are rendered as HTML pages.</p><p>Choosing between presigned URLs and public buckets is dependent on your specific use case. You can also use both if your architecture should use public buckets in one situation and presigned URLs in another. It is useful to note that presigned URLs will expose your account ID and bucket name to whoever gets a copy of the URL. Public bucket URLs do not contain the account ID or bucket name. Typically, you will not share presigned URLs directly with end users or browsers, as presigned URLs are used more for internal applications.</p><h2 id=related-resources><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#related-resources>&#8203;​</a></span>
<span>Related resources</span></h2><ul><li><a href=/r2/data-access/public-buckets/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Create a public bucket</span></a></li></ul></article></div></main><footer class=DocsFooter><div class=DocsFooter--content><div class=DocsFooterResources><span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/r2" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Dashboard</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://discord.com/channels/595317990191398933/940663374377783388 class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Discord</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://community.cloudflare.com/c/developers/workers/40 class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Community</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://www.cloudflare.com/learning/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Learning Center</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/support" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Support Portal</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span></div><div><span class=DocsFooter--edit-on-gh-link-wrapper><a href=https://github.com/panthere2k/panthere2k.github.io/blob/content/content/r2/data-access/s3-api/presigned-urls.md class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Edit on GitHub</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-time>Updated <time class=relative datetime=2023-01-02T09:58:19+09:00 title=2023-01-02>January 2, 2023</time></span></div></div></footer></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKQFGQB" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PKQFGQB")</script><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style></noscript><script defer src=https://unpkg.com/littlefoot/dist/littlefoot.js type=application/javascript></script>
<script type=application/javascript>document.addEventListener("DOMContentLoaded",()=>littlefoot.default())</script></body></html>