<!doctype html><html lang=en theme=light is-docs-page js-focus-visible-polyfill-available><head><meta charset=utf-8><title>Integrate Cloudflare Images on your website · Cloudflare Image Optimization docs</title><meta http-equiv=cleartype content="on"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=application-name content="Integrate Cloudflare Images on your website · Cloudflare Image Optimization docs"><meta name=msapplication-tap-highlight content="no"><meta name=apple-mobile-web-app-title content="Integrate Cloudflare Images on your website · Cloudflare Image Optimization docs"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-capable content="yes"><meta name=mobile-web-app-capable content="yes"><meta name=theme-color content="#f38020"><meta name=description content="Choose between Cloudflare Images and Cloudflare Image Resizing, two products tailored to your different needs."><meta property="og:image" content="https://panthere2k.github.io/dev-products-preview.png"><meta property="og:title" content="Integrate Cloudflare Images on your website · Cloudflare Image Optimization docs"><meta property="og:description" content="Choose between Cloudflare Images and Cloudflare Image Resizing, two products tailored to your different needs."><meta property="og:type" content="website"><meta name=twitter:title content="Integrate Cloudflare Images on your website · Cloudflare Image Optimization docs"><meta name=twitter:image content="https://panthere2k.github.io/dev-products-preview.png"><meta name=twitter:description content="Choose between Cloudflare Images and Cloudflare Image Resizing, two products tailored to your different needs."><meta name=twitter:creator content="@cloudflare"><meta name=twitter:card content="summary_large_image"><meta name=pcx_content_type content="tutorial"><link rel=icon href=/favicon-32x32.png><link rel=canonical href=https://panthere2k.github.io/images/cloudflare-images/tutorials/integrate-cloudflare-images/><link rel=sitemap href=/sitemap.xml type=application/xml><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon sizes=48x48 href=/icons/icon-48x48.png><link rel=apple-touch-icon sizes=72x72 href=/icons/icon-72x72.png><link rel=apple-touch-icon sizes=96x96 href=/icons/icon-96x96.png><link rel=apple-touch-icon sizes=144x144 href=/icons/icon-144x144.png><link rel=apple-touch-icon sizes=192x192 href=/icons/icon-192x192.png><link rel=apple-touch-icon sizes=256x256 href=/icons/icon-256x256.png><link rel=apple-touch-icon sizes=384x384 href=/icons/icon-384x384.png><link rel=apple-touch-icon sizes=512x512 href=/icons/icon-512x512.png><script src=/search.redirect.min.6828ce878577fe91120d67814d68c0d8.js defer></script><link rel="stylesheet preconnect" href=/style.css><script>(function(){let s=!1,e,n;document.readyState!=="loading"?o():addEventListener("DOMContentLoaded",o),e=document.querySelector("#ThemeToggle"),s=!e;function t(n){try{let o=n?"dark":"light";document.documentElement.setAttribute("theme",o),localStorage.theme=JSON.stringify({theme:o}),e?(e.checked=n,s=!1):s&&setTimeout(t,1,n)}catch{}}function o(){e=e||document.querySelector("#ThemeToggle"),e.addEventListener("change",()=>t(!!e.checked)),addEventListener("keydown",n=>{n.target===document.body&&n.which===68&&n.shiftKey&&(n.preventDefault(),t(!e.checked))})}try{n=window.matchMedia("(prefers-color-scheme:dark)"),n.onchange=e=>t(e.matches)}catch{}try{let e=localStorage.theme,s=e&&JSON.parse(e);t(s?/dark/.test(s.theme):!!(n&&n.matches))}catch{}})()</script><script src=/main.min.c2a5e976c412695a3d9389cba84aa5bd.js defer></script>
<script data-source=docs defer src=https://feedback.developers.cloudflare.com/sdk.js></script>
<link rel=preload href=https://feedback.developers.cloudflare.com/sdk.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://feedback.developers.cloudflare.com/sdk.css></noscript></head><body><div class=DocsPage><div><a class=skip-link href=#main>Skip to content</a></div><div class=DocsMobileHeader><a class="DocsMobileHeader--cloudflare-logo-link Link Link-without-underline" href=/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsMobileTitleHeader><a aria-current=page class="DocsMobileTitleHeader--logo-link Link Link-without-underline" href=/images/><div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap"><div class=DocsNavLogoLockup--logo><span title="Cloudflare Cloudflare Image Optimization logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M42 8.94H6l-1.5 1.5v29.903l1.5 1.5h36l1.5-1.5V10.44L42 8.94zm-1.5 3v14.018l-6-4.913-1.965.06-3.81 3.51-4.073-3-1.852.06-10.5 8.775-4.8-3.3V11.94h33zm-33 26.903V30.81l3.975 2.775 1.815-.082 10.523-8.753 4.125 3 1.905-.105 3.75-3.472 6.907 5.655v9l-33 .015zm6.81-14.723a3 3 0 100-6 3 3 0 000 6z"/></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:29>Cloudflare Image Optimization</span></span></div></a><button class="Button DocsMobileTitleHeader--sidebar-toggle-button">
<span class=DocsMobileTitleHeader--sidebar-toggle-button-icon aria-hidden=true><svg viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="title-1332672649688018" xmlns="http://www.w3.org/2000/svg"><title id="title-1332672649688018">Navigation menu icon</title><path data-index="1" d="M5 7h10" transform-origin="10 7"/><path data-index="2" d="M5 10h10" transform-origin="10 10"/><path data-index="3" d="M5 13h10" transform-origin="10 13"/></svg><span is-visually-hidden>Open external link</span></span></button></div><div class=DocsMobileNavBackdrop></div><div class=DocsSidebar><div class=DocsSidebar--sections><div class="DocsSidebar--section DocsSidebar--header-section"><a class="DocsSidebar--cloudflare-logo-link DocsSidebar--link" href=/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><svg viewBox="0 0 48 48" fill="currentcolor" role="img" aria-labelledby="title-27458391960035233" xmlns="http://www.w3.org/2000/svg"><title id="title-27458391960035233">Security365 Docs logomark</title><path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262.0 01-.221-.122.348.348.0 01-.035-.267.396.396.0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503.0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15.0-7.672 2.798-8.931 6.679a4.156 4.156.0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84.0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29.0.304.024.608.059.912.023.146.14.256.28.256h26.488c.151.0.291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zm4.826-7.327c-.128.0-.268.0-.396.012-.093.0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093.0.175.049.222.122a.356.356.0 01.035.267.396.396.0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289.0 00.28-.219 8.654 8.654.0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"/></svg></div><span class=DocsNavLogoLockup--text><span data-text=Cloudflare>Security365</span>
<span data-text=Docs>Docs</span></span></div></a></div><div class=DocsSidebar--section-separator></div><div class="DocsSidebar--section DocsSidebar--docs-title-section"><a aria-current=page class="DocsSidebar--docs-title-logo-link DocsSidebar--link" href=/images/><div class=DocsNavLogoLockup><div class=DocsNavLogoLockup--logo><span title="Cloudflare Cloudflare Image Optimization logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M42 8.94H6l-1.5 1.5v29.903l1.5 1.5h36l1.5-1.5V10.44L42 8.94zm-1.5 3v14.018l-6-4.913-1.965.06-3.81 3.51-4.073-3-1.852.06-10.5 8.775-4.8-3.3V11.94h33zm-33 26.903V30.81l3.975 2.775 1.815-.082 10.523-8.753 4.125 3 1.905-.105 3.75-3.472 6.907 5.655v9l-33 .015zm6.81-14.723a3 3 0 100-6 3 3 0 000 6z"/></svg></span></div><span class=DocsNavLogoLockup--text><span class=DocsSidebar--docs-title-text-scaler style=--length:29>Cloudflare Image Optimization</span></span></div></a><div class="DocsSidebar--section-more Dropdown" data-expanded=false><button class="DocsSidebar--section-more-button Button" aria-expanded=false><div class=DocsSidebar--section-more-button-icon><svg viewBox="0 0 4 16" stroke="currentcolor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" fill="currentcolor" role="img" aria-labelledby="title-6032186738345315" xmlns="http://www.w3.org/2000/svg"><title id="title-6032186738345315">Dropdown icon</title><path d="M2 2v0m0 6v0m0 6v0z"/></svg><span is-visually-hidden>Cloudflare Image Optimization menu</span></div></button><div class="DocsSidebar--section-more-dropdown Dropdown--dropdown"><ul class=Dropdown--list><li class=Dropdown--item><a class=Dropdown--link href=https://cloudflare.com tabindex=-1>Cloudflare homepage</a></li></ul></div></div></div><div class="DocsSidebar--section DocsSidebar--nav-section" style=position:relative;overflow:hidden;width:100%;height:100%><div style=position:absolute;inset:0;overflow-y:auto;margin-right:0;margin-bottom:0><div class=DocsSidebar--nav-section-shadow style=opacity:0></div><ul class=DocsSidebar--nav><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Overview</span></a></li><li class=DocsSidebar--nav-item is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Cloudflare Images</span>
</button><a class=DocsSidebar--nav-link href=/images/cloudflare-images/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Cloudflare Images</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style=min-height:0;transition-duration:400ms is-expanded><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/api-request/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Make your first API request</span></a></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Upload images</span>
</button><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Upload images</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/dashboard-upload/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Images dashboard</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/direct-creator-upload/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Direct Creator Upload</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/upload-via-url/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>URL upload</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/custom-id/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Custom ID</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/upload-images/formats-limitations/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Formats and limitations</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Edit images</span>
</button><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Edit images</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/resize-images/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Resize images</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/flexible-variants/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Flexible variants</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/blur-images/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Blur images</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/edit-images/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Edit images</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/delete-images/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Delete images</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/delete-variants/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Delete variants</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/transform/export-image/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Export images</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Serve images</span>
</button><a class=DocsSidebar--nav-link href=/images/cloudflare-images/serve-images/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Serve images</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/serve-images/adaptive-images-format/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Adaptive image format</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/serve-images/serve-images-custom-domains/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Custom domains</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/serve-images/serve-private-images-using-signed-url-tokens/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Serve private images</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Sourcing Kit (beta)</span>
</button><a class=DocsSidebar--nav-link href=/images/cloudflare-images/sourcing-kit/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Sourcing Kit (beta)</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=2 style=--depth:2><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/sourcing-kit/enable/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Enable Sourcing Kit</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/sourcing-kit/edit/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Edit sources</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/sourcing-kit/credentials/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Credentials</span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/make-an-image-private/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Make an image private</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/cloudflare-images/images-analytics/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Analytics</span></a></li><li class=DocsSidebar--nav-item is-active-root is-expanded><a class=DocsSidebar--nav-link href=/images/cloudflare-images/tutorials/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Tutorials</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=https://developers.cloudflare.com/api/operations/cloudflare-images-list-images><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>API reference</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Cloudflare Image Resizing</span>
</button><a class=DocsSidebar--nav-link href=/images/image-resizing/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Cloudflare Image Resizing</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/enable-image-resizing/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Enable Image Resizing</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/format-limitations/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Formats and limitations</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/url-format/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>URL format</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/responsive-images/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Responsive images</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/resize-with-workers/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Resize with Cloudflare Workers</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/draw-overlays/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Draw overlays and watermarks</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/control-origin-access/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Control origin access</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/image-resizing/integration-with-frameworks/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Integration with frameworks</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=https://developers.cloudflare.com/api/operations/zone-settings-get-image-resizing-setting tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>API reference</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><button class="Button DocsSidebar--nav-expand-collapse-button">
<span class=DocsSidebar--nav-expand-collapse-button-content aria-hidden=true></span>
<span is-visually-hidden>Expand: Cloudflare Polish</span>
</button><a class=DocsSidebar--nav-link href=/images/polish/>
<span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Cloudflare Polish</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style=min-height:0><div class=DocsSidebar--nav-item-collapse-wrapper><div class=DocsSidebar--nav-item-collapse-wrapperInner><div class=DocsSidebar--nav-item-collapse-content><ul class=DocsSidebar--nav-subnav depth=1 style=--depth:1><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/polish/activate-polish/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Activate Polish</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/polish/compression/ tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>Polish compression</span></a></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=https://developers.cloudflare.com/api/operations/zone-settings-get-polish-setting tabindex=-1><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>API reference</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></li></ul></div></div></div></div></li><li class=DocsSidebar--nav-item><a class=DocsSidebar--nav-link href=/images/faq/><span class=DocsSidebar--nav-link-highlight></span>
<span class=DocsSidebar--nav-link-text>FAQ</span></a></li></ul></div><div style=position:absolute;height:6px;display:none;right:2px;bottom:2px;left:2px;border-radius:3px><div style=position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)></div></div><div style=position:absolute;width:6px;display:none class="Scrollbars--track Scrollbars--track-vertical"><div style=position:relative;display:block;width:100% class="Scrollbars--thumb Scrollbars--thumb-vertical"></div></div></div><div class=toggleSidebar><button id=toggleSidebarButton style=width:2em;height:2em title="Click to collapse and expand the sidebar navigation"><svg id="toggleSidebarSVG" aria-hidden="true" height="1" width="1" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path id="toggleSidebarSVGPath" d="M15 2a1 1 0 00-1 1v10a1 1 0 002 0V3a1 1 0 00-1-1zm-10.407.993-4.3 4.3a1 1 0 000 1.414l4.3 4.3a1 1 0 001.415-1.416L3.417 9H10a1 1 0 100-2H3.417l2.591-2.591A1 1 0 104.593 2.993z"/></svg></button></div></div><div class=DocsSidebar--shadow></div></div><div class=DocsToolbar><div class=DocsToolbar--search><div class=DocsSearch><div class=DocsSearch--input-wrapper><input type=text id=DocsSearch--input class=DocsSearch--input spellcheck=false autocomplete=false placeholder="Search docs..."><div class=DocsSearch--input-icon><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-9701125841014673" xmlns="http://www.w3.org/2000/svg"><title id="title-9701125841014673">Search icon (depiction of a magnifying glass)</title><path d="M11.999 10.585l3.458 3.458a1 1 0 01-1.414 1.414L10.585 12a6.5 6.5.0 111.414-1.414zM6.75 11.5a4.75 4.75.0 100-9.5 4.75 4.75.0 000 9.5z"/></svg></div><button disabled class=slashPlaceholder title="Press '/' to focus on the search bar" aria-label="Forward slash keyboard shortcut" tabindex=-1 type=button><div style=margin-top:-1px>/</span></div></button></div></div></div><div class=DocsToolbar--tools><button data-feedback=true class="DocsToolbar--feedback Button Button-is-docs-secondary">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17"><path d="M14 2.5H2l-.5.5v11.165l.863.345 2.852-3.01H14l.5-.5V3l-.5-.5zm-.5 8H4.785L2.5 12.911V3.5h11v7z" fill="currentcolor"/><path d="M12.5 5.003h-9v1h9v-1zm0 2.497h-9v1h9v-1z" fill="currentcolor"/></svg>Give Feedback</button><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--tools-icon-item><div class=Tooltip---root><div class=DocsToolbar--tools-icon-item-content><a class="Link Link-without-underline" href=https://github.com/cloudflare/cloudflare-docs><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-6991762763429039" xmlns="http://www.w3.org/2000/svg"><title id="title-6991762763429039">GitHub icon</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"/></svg></a></div><span class=Tooltip role=tooltip position=bottom-end>Visit Cloudflare Image Optimization on GitHub</span></div></div><div class=DocsToolbar--tools-spacer></div><div class=DocsToolbar--theme-toggle><div class=Tooltip---root><div class=ThemeToggle><input type=checkbox id=ThemeToggle class=ThemeToggle--input>
<label class=ThemeToggle--toggle for=ThemeToggle><div class=ThemeToggle--toggle-handle></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--sun"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-8812071124069258" xmlns="http://www.w3.org/2000/svg"><title id="title-8812071124069258">Light theme icon (depiction of a sun)</title><path d="M7.5 11.465a3.482 3.482.0 01-1.596-.662L4.11 12.596a.5.5.0 01-.707-.707l1.793-1.793A3.482 3.482.0 014.535 8.5H2a.5.5.0 010-1h2.535a3.482 3.482.0 01.662-1.596L3.404 4.11a.5.5.0 01.707-.707l1.793 1.793A3.482 3.482.0 017.5 4.535V2a.5.5.0 011 0v2.535a3.482 3.482.0 011.596.662l1.793-1.793a.5.5.0 01.707.707l-1.793 1.793c.343.458.577 1.003.662 1.596H14a.5.5.0 110 1h-2.535a3.482 3.482.0 01-.662 1.596l1.793 1.793a.5.5.0 01-.707.707l-1.793-1.793a3.482 3.482.0 01-1.596.662V14a.5.5.0 11-1 0v-2.535z"/></svg></div><div class="ThemeToggle--toggle-handle-icon ThemeToggle--moon"><svg viewBox="0 0 16 16" fill="currentcolor" role="img" aria-labelledby="title-5971296394189265" xmlns="http://www.w3.org/2000/svg"><title id="title-5971296394189265">Dark theme icon (depiction of a moon)</title><path d="M7.067 3.087a5 5 0 005.466 7.026A5 5 0 117.067 3.087z"/></svg></div></label><span class=Tooltip role=tooltip position=bottom-end>Set theme to dark (⇧+D)</span></div></div></div></div></div><main class=DocsBody><div class=DocsBody--sidebar with-styled-webkit-scrollbars><div class=DocsBody--sidebar-content-scroll-fade></div><div class=DocsBody--sidebar-content><ul class=DocsTableOfContents hidden><li><a class=DocsTableOfContents-link href=#docs-content>↑ Top</a></li></ul></nav></div></div><div id=docs-content data-reach-skip-nav-content></div><div class=DocsContent id=main page-type=document><article class=DocsMarkdown><h1 id=integrate-cloudflare-images-on-your-website>Integrate Cloudflare Images on your website</h1><h2 id=overview><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#overview>&#8203;​</a></span>
<span>Overview</span></h2><p>In this tutorial, you will update a website in several iterative steps to leverage the powerful features of <a href=/images/cloudflare-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Cloudflare Images</span></a>. Cloudflare Images is a great solution for a website as an easy-to-use image storage, transformation and optimized delivery service.</p><p>You will learn:</p><ul><li>How to migrate your website&rsquo;s images to Cloudflare images.</li><li>How to update your website <a href=/images/cloudflare-images/serve-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>to serve images from Cloudflare Images</span></a>, ultimately without changing the existing image URLs.</li><li>How to use <a href=/images/cloudflare-images/transform/resize-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>variants</span></a> to resize and transform delivered images.</li></ul><p>Other features you will learn about:</p><ul><li><a href=/images/cloudflare-images/serve-images/#serving-images-from-custom-domains class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Custom Domain Delivery</span></a>: How to serve Cloudflare Images from your own domain name.</li><li><a href=/images/cloudflare-images/upload-images/custom-id/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Custom IDs</span></a>: How to store and serve your images under their own, SEO friendly Unicode name and path.</li><li><a href=/images/cloudflare-images/transform/flexible-variants/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Flexible Image transformation</span></a>: How to use transformation parameters in the delivery URL to transform an image on the fly.</li><li>Adaptive Optimized Format Delivery: How Cloudflare Images delivers image formats optimized to every browser, including WebP and AVIF.</li></ul><h3 id=demo-website-and-source-code><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#demo-website-and-source-code>&#8203;​</a></span>
<span>Demo website and source code</span></h3><p>For illustrative purposes, this tutorial uses the <a href=https://imagejam.net class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Imagejam demo website</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> build with <a href=/pages/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Cloudflare Pages</span></a> as a basis for all examples. You can find the source code for this demo website on <a href=https://github.com/netgusto/imagejam.net class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>GitHub</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p><a href=/pages/get-started/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Learn how to deploy your own Cloudflare Pages website</span></a>.</p><h2 id=website-not-using-cloudflare-images><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#website-not-using-cloudflare-images>&#8203;​</a></span>
<span>Website not using Cloudflare Images</span></h2><p>The demo website we are going to use for this tutorial is not (yet) using Cloudflare Images. If you <a href=https://imagejam.net/step-1/cakes/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>browse the cake gallery</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> page for Step 1, you can see many image thumbnails.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-01-cakes.jpg alt="The demo website has lots of thumbnail images of cakes."></p><p>Selecting an image displays a bigger version of it, as well as its URL, real size and display size.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-01-cake.jpg alt="Selecting the thumnail shows a bigger version of the image, and its real size."></p><p>On this example, the image was served with a very high-resolution of 4288x2848 pixels, but is displayed at a much lower resolution. This means most of the pixels we downloaded were wasted upon display.</p><p>This happens because, right now, the website is serving the original unoptimized and unresized images, stored in an online file storage (in our case, S3). On the other hand, although it cannot be inferred at a first glance, the image is being served in a fairly heavy JPG format that has not been optimized for the web - and that possibly come directly from a camera.</p><p>Right now, images are being served from the website&rsquo;s domain. For instance, our original image <code>cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg</code> is served from the URL <code>https://imagejam.net/images/public/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg</code>.</p><p>In our Cloudflare Pages website demo, URLs for image delivery are defined in the file <a href=https://github.com/netgusto/imagejam.net/blob/production/config.js class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content><code>/config.js</code></span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>, in the build step configuration for Step 1.</p><p>Here is the relevant extract of this file (edited for brevity):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Step 1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>image_url</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>image_name</span><span class=p>,</span> <span class=nx>variant</span><span class=p>,</span> <span class=nx>config</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>config</span><span class=p>.</span><span class=nx>site_url</span> <span class=o>+</span> <span class=s2>&#34;/images/&#34;</span> <span class=o>+</span> <span class=nx>variant</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>image_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span>
</span></span></code></pre></div><p>This configuration provides an <code>image_url</code> function used when building the HTML of the website, that generates the URLs to our website&rsquo;s images — in this case, served directly by the website and <strong>not</strong> by Cloudflare Images.</p><p>The purpose of this tutorial is to showcase how Cloudflare Images can be integrated on a website to deliver resized and optimized images, adapted to your display and the browser displaying them.</p><p>👉 In Step 2 we will integrate Cloudflare Images in our website, but before that we need to upload our images for Cloudflare Images to start serving them.</p><h2 id=step-1---migrate-images-to-cloudflare-images><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#step-1---migrate-images-to-cloudflare-images>&#8203;​</a></span>
<span>Step 1 - Migrate images to Cloudflare Images</span></h2><p>You need to start by uploading your images to Cloudflare Images. For that, you need a Cloudflare Account with a Cloudflare Images subscription. Head over to the <a href=https://dash.cloudflare.com/sign-up/images class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Images sign-up page</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> to sign up.</p><p>After signing up, go to <a href="https://dash.cloudflare.com/?to=/:account/images" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>the Cloudflare Images dashboard</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-images-dashboard.jpg alt="The Cloudflare Images dashboard."></p><p>From there, you could upload all your website images manually using the dashboard UI. However, we have a lot of images on our website, so we are going to import them in bulk using the <a href=/images/cloudflare-images/upload-images/custom-id/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>API upload</span></a>.</p><p>The demo website source code contains a NodeJS script with one way to achieve bulk upload to Cloudflare Images. You can find the script in <a href=https://github.com/netgusto/imagejam.net/blob/production/scripts/migrate/bulkupload.js class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content><code>scripts/migrate/bulkupload.js</code></span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p>Here is that script, slightly edited for illustrative purposes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=nx>filename</span><span class=o>:</span> <span class=s2>&#34;scripts/migrate/bulkupload.js&#34;</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// URL where your original images are accessible
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>imageOriginURL</span> <span class=o>=</span> <span class=s2>&#34;https://imagejam.s3.amazonaws.com/&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>images</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cakes/aliet-kitchen-qrDbj7OV2EU-unsplash-ツ.jpg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cakes/amirali-mirhashemian-cZFU60dKB6U-unsplash.jpg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// obtain the list of images to import in any way...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>bulkUpload</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>bulkUpload</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=nx>image_name</span> <span class=k>in</span> <span class=nx>images</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>upload</span><span class=p>(</span><span class=nx>image_name</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>CF_IMAGES_ACCOUNT_ID</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>CF_IMAGES_API_KEY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>upload</span><span class=p>(</span><span class=nx>imageName</span><span class=p>,</span> <span class=nx>CF_IMAGES_ACCOUNT_ID</span><span class=p>,</span> <span class=nx>CF_IMAGES_API_KEY</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Upload image to Cloudflare Images
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// CF Images will download the image hosted at the provided URL and store it
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Leverages Upload by URL and Custom ID features of Cloudflare Images
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// see https://developers.cloudflare.com/images/cloudflare-images/upload-images/custom-id/
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Uploading to Cloudflare Images: </span><span class=si>${</span><span class=nx>imageName</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// tell CF Images to fetch this image for us
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>body</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s2>&#34;url&#34;</span><span class=p>,</span> <span class=nx>imageOriginURL</span> <span class=o>+</span> <span class=nx>imageName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// tell CF Images that we want our image to have this ID (ie, its current name)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>body</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s2>&#34;id&#34;</span><span class=p>,</span> <span class=nx>imageName</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sb>`https://api.cloudflare.com/client/v4/accounts/</span><span class=si>${</span><span class=nx>CF_IMAGES_ACCOUNT_ID</span><span class=si>}</span><span class=sb>/images/v1`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>method</span><span class=o>:</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;Authorization&#34;</span><span class=o>:</span> <span class=sb>`Bearer </span><span class=si>${</span><span class=nx>CF_IMAGES_API_KEY</span><span class=si>}</span><span class=sb>`</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>status</span> <span class=o>!==</span> <span class=mi>200</span> <span class=o>&amp;&amp;</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span> <span class=o>!==</span> <span class=mi>409</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s2>&#34;HTTP &#34;</span> <span class=o>+</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span> <span class=o>+</span> <span class=s2>&#34; : &#34;</span> <span class=o>+</span> <span class=kr>await</span> <span class=nx>res</span><span class=p>.</span><span class=nx>text</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>409</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 409: image already exists, imported by a previous run
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Already exist: &#34;</span> <span class=o>+</span> <span class=nx>imageName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;ERROR:&#34;</span> <span class=o>+</span> <span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>In a nutshell, this script does two things:</p><ul><li>Obtains the list of images to migrate to Cloudflare Images;</li><li>For every image, ask the Cloudflare Images API to import the image by URL, keeping its current name.</li></ul><p><a href=https://github.com/netgusto/imagejam.net#migrating-the-website-images-to-cloudflare-images class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Check out the instructions on how to install and run this script on the demo website GitHub repository</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p>If you need Cloudflare Images API credentials, refer to <a href=#obtain-cloudflare-images-api-credentials class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Obtain Cloudflare Images API credentials</span></a> below.</p><h2 id=step-2-use-cloudflare-images-on-default-delivery-domain><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#step-2-use-cloudflare-images-on-default-delivery-domain>&#8203;​</a></span>
<span>Step 2: Use Cloudflare Images on default delivery domain</span></h2><p>Now that your website images <a href=#migrate-images-to-cloudflare-images class=DocsMarkdown--link><span class=DocsMarkdown--link-content>have been imported</span></a>, they are already accessible on Cloudflare Images. Zero setup required!</p><p>For instance, our original image <code>cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg</code> is served on the URL <code>https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg/public</code>.</p><p><img src=https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-%E3%83%84.jpg/public alt="Cake with red fruits on top, and a fork on the side."><br>(<em>Photo by Aditya Joshi - Unsplash</em>)</p><p>If we inspect the URL:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg/public
</span></span><span class=line><span class=cl>&lt;--  default domain   --&gt;/&lt;-- Account hash   --&gt;/&lt;--        our original image file        --&gt;/&lt;-variant-&gt;
</span></span></code></pre></div><ul><li><code>https://imagedelivery.net</code> is the default delivery domain for Cloudflare Images.</li><li><code>-oMiRxTrr3JCvTMIzx4GvA</code> represents your Cloudflare Images account ID in an obfuscated way. You can get this value in <a href=/images/cloudflare-images/serve-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>your Cloudflare Images dashboard</span></a>.</li><li><code>cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg</code> is the original file name. This is the image ID we need to serve it.</li><li><code>public</code> <a href=/images/cloudflare-images/transform/resize-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>represents the variant</span></a>. This is how Cloudflare Images knows what image size should be served, <a href=/images/cloudflare-images/transform/flexible-variants/#supported-properties class=DocsMarkdown--link><span class=DocsMarkdown--link-content>among many other transformation options</span></a>.</li></ul><p>Cloudflare Images ships by default with a single variant named <code>public</code>, but you can create more variants to fit your needs.</p><p>For this tutorial, we created a second variant named <code>thumb</code> with 200x200 pixels, with a <code>cover</code> crop.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-variant-thumb.jpg alt="The settings for the &amp;ldquo;thumb&amp;rdquo; variant created in Cloudflare Images dash"></p><p>Using the same image as before but with the <code>thumb</code> variant, we get a <a href=https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-%E3%83%84.jpg/thumb class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>much smaller file</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p><img src=https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-%E3%83%84.jpg/thumb alt="The previous cake image, but smaller due to the new variant applied"></p><p>This variant is used in the thumbnails pages of our website gallery.</p><h3 id=update-the-website-to-use-cloudflare-images><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#update-the-website-to-use-cloudflare-images>&#8203;​</a></span>
<span>Update the website to use Cloudflare Images</span></h3><p>In the previous section we learned that Cloudflare Images is ready to serve images without any further setup.</p><p>Now, let us update our website to serve images using Cloudflare Images. In our demo Cloudflare Pages website, this is done in <a href=https://github.com/netgusto/imagejam.net/blob/production/config.js class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content><code>/config.js</code></span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>, by adding a build step to the configuration:</p><p>Here is the relevant extract of this file (edited for brevity):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Step 2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>image_url</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>image_name</span><span class=p>,</span> <span class=nx>variant</span><span class=p>,</span> <span class=nx>config</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;https://imagedelivery.net/&#34;</span> <span class=o>+</span> <span class=nx>config</span><span class=p>.</span><span class=nx>cloudflare_images_account_hash</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>image_name</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>variant</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span>
</span></span></code></pre></div><p>This configuration provides an <code>image_url</code> function that is used when building the HTML of the website to generate our image URLs. In this case, the images are also served by Cloudflare Images on the default delivery domain <code>https://imagedelivery.net</code>.</p><p>Once deployed, your website will have <a href=https://imagejam.net/step-2/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>much smaller thumbnails</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>, all resized and optimized by Cloudflare Images. Selecting an image, will show that, as expected, they are being served by Cloudflare Images. Their URL will be similar to <code>https://imagedelivery.net/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg/public</code>.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-cake.jpg alt="The URL for the image shows it&amp;rsquo;s being served by Cloudflare images"></p><p>Note as well that the displayed size now matches the real size of the image much more closely, if not perfectly. No more wasted downloaded pixels!</p><h3 id=adaptive-optimized-format-delivery><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#adaptive-optimized-format-delivery>&#8203;​</a></span>
<span>Adaptive Optimized Format Delivery</span></h3><p><a href=/images/cloudflare-images/serve-images/adaptive-images-format/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Adaptive Optimized Format Delivery</span></a> is a built-in feature of Cloudflare Images. This feature allows Cloudflare Images to automatically serve the best image format to the browser.</p><p>Inspecting the details of this image reveals that Cloudflare Images converted it to AVIF, shaving close to 50% in file size in the process, when compared to a JPG of the same resolution. This was made while maintaining the same quality.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-avif.jpg alt="Inspecting the image in Chrome show it was converted to AVIF."></p><p>This happens because the browser used (Google Chrome in the screenshot) supports AVIF. Chrome advertises its AVIF support in the <code>Accept: image/avif</code> header it sends to Cloudflare Images while requesting the image. If you use another browser that does not support AVIF (like Firefox), Cloudflare Images will, instead, serve the image in WebP.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-webp-firefox.jpg alt="Inspecting the image in Firefox shows it was converted to WebP"></p><h2 id=step-3-use-cloudflare-images-on-custom-delivery-domain><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#step-3-use-cloudflare-images-on-custom-delivery-domain>&#8203;​</a></span>
<span>Step 3: Use Cloudflare Images on custom delivery domain</span></h2><p>In <a href=#step-2-use-cloudflare-images-on-default-delivery-domain class=DocsMarkdown--link><span class=DocsMarkdown--link-content>step 2</span></a>, you learned how Cloudflare Images serves images on its default delivery domain.</p><p>However, Cloudflare Images can also serve images from <a href=/images/cloudflare-images/serve-images/#serving-images-from-custom-domains class=DocsMarkdown--link><span class=DocsMarkdown--link-content>custom domains</span></a>, no setup required — as long as the domain name is proxied by Cloudflare.</p><p>For instance, our original image <code>cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg</code> can be served from the URL <code>https://imagejam.net/cdn-cgi/imagedelivery/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg/public</code>.</p><p>This URL is similar to those on Step 2, with these key differences:</p><ul><li>The domain name is our website&rsquo;s (<code>https://imagejam.net</code>) instead of the Cloudflare Images default domain (<code>https://imagedelivery.net</code>).</li><li>There is an extra <code>/cdn-cgi/imagedelivery/</code> at the beginning of the path, allowing Cloudflare to automatically identify this URL as a Cloudflare Image, and serve it accordingly.</li></ul><h3 id=update-the-website-to-use-your-custom-domain><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#update-the-website-to-use-your-custom-domain>&#8203;​</a></span>
<span>Update the website to use your custom domain</span></h3><p>In our Cloudflare Pages demo website, the custom domain options is done in <a href=https://github.com/netgusto/imagejam.net/blob/production/config.js class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content><code>/config.js</code></span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>, by adding a third build step configuration:</p><p>Here is the relevant extract of this file (edited for brevity):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Step 3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>image_url</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>image_name</span><span class=p>,</span> <span class=nx>variant</span><span class=p>,</span> <span class=nx>config</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>config</span><span class=p>.</span><span class=nx>site_url</span> <span class=o>+</span> <span class=s2>&#34;/cdn-cgi/imagedelivery/&#34;</span> <span class=o>+</span> <span class=nx>config</span><span class=p>.</span><span class=nx>cloudflare_images_account_hash</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>image_name</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>variant</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span>
</span></span></code></pre></div><p>Once deployed, every image will be served from the custom domain. You can check this by <a href=https://imagejam.net/step-3/cakes/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>browsing the cake gallery</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> page for step 3. Selecting any image will show that its URL is as expected <code>https://imagejam.net/cdn-cgi/imagedelivery/-oMiRxTrr3JCvTMIzx4GvA/cakes/aditya-joshi--DUN-_bTO2Q-unsplash-ツ.jpg/public</code>.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-03-cake.jpg alt="The URL for the image shows that it is being served from a custom domain"></p><h2 id=step-4-use-cloudflare-images-without-changing-existing-images-urls><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#step-4-use-cloudflare-images-without-changing-existing-images-urls>&#8203;​</a></span>
<span>Step 4: Use Cloudflare Images without changing existing images URLs</span></h2><p>So far we have shown you how to integrate Cloudflare Images in your website by changing the images&rsquo; URLs to target the Cloudflare Images services.</p><p>While this is a easy, zero-setup way to optimize your image delivery, you might prefer to have your own URLs and website code unchanged, and still benefit from all the Cloudflare Images features.</p><p>This is possible by having a Cloudflare Worker intercepting the traffic of your unchanged image URLs, and transparently relaying it to Cloudflare Images.</p><p>The code for our Cloudflare Pages demo website is shipped with such a Worker. You can find it in <a href=https://github.com/netgusto/imagejam.net/blob/production/images-worker/index.js class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content><code>/images-worker/index.js</code></span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span>
</span></a>.</p><p>Here is the relevant extract of this file (edited for brevity):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>handleRequest</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>variant</span><span class=p>,</span> <span class=nx>imageName</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>extractVariant</span><span class=p>(</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>variant</span> <span class=o>||</span> <span class=o>!</span><span class=nx>imageName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>notFound</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Use Cloudflare Images to deliver image ✨
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// by constructing the CF Images URL with parts extracted from
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// the original website image URLs that this worker intercepts
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;https://imagedelivery.net/&#34;</span> <span class=o>+</span> <span class=nx>config</span><span class=p>.</span><span class=nx>cloudflare_images_account_hash</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>imageName</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>variant</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// relay request headers to Cloudflare Images,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// to inform about the media types accepted by the HTTP client
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>headers</span><span class=o>:</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>extractVariant</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// takes website URLs like /images/public/cakes/gateau.jpg
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// and identifies the variant (here, &#34;public&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// and imageName ( here, &#34;cakes/gateau.jpg&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>parts</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=s2>&#34;/images/&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>).</span><span class=nx>split</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>variant</span> <span class=o>=</span> <span class=nx>parts</span><span class=p>.</span><span class=nx>shift</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span> <span class=nx>variant</span><span class=o>:</span> <span class=nx>variant</span><span class=p>,</span> <span class=nx>imageName</span><span class=o>:</span> <span class=nx>parts</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>In a nutshell, this code receives HTTP requests for images on they original URLs, and relays them transparently to Cloudflare Images before responding to the HTTP client, effectively proxying traffic between your website and Cloudflare Images.</p><p>Once the worker is deployed, your website will use Cloudflare Images with the original, unchanged URLs. Refer to <a href=https://imagejam.net/step-4/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Step 4</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a> in the demo website the check the result.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-04-url.jpg alt="The optimized image by Cloudflare Images, with an unchanged URL"></p><p>For more information about how to publish a Worker on your Cloudflare account, refer to Cloudflare&rsquo;s <a href=/workers/get-started/guide/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Workers documentation</span></a>.</p><p>Note, however, that for the Worker to intercept traffic on your existing images URLs, it must be mapped to a route matching the URLs of your existing images. This is done in your Workers dashboard, under the tab <strong>Triggers</strong>. For more information, refer to our documentation on <a href=/workers/platform/triggers/routes/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Workers Routes</span></a>.</p><p>In this case, the Worker was set up to trigger on the route <code>imagejam.net/images/*</code></p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-04-worker-route.jpg alt="A Cloudflare Worker configured to intercept the proper images folder"></p><h2 id=conclusion><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#conclusion>&#8203;​</a></span>
<span>Conclusion</span></h2><p>In this tutorial, you learned how to integrate Cloudflare Images in an existing website. You have also learned how low-profile Cloudflare Images can be, requiring zero changes on your website HTML or URLs if necessary.</p><p>We discovered how Cloudflare Images adapts the format and compression of Images upon delivery depending on the browser capabilities, to ensure the best end-user experience possible.</p><p>If you enjoyed this tutorial, refer to the <a href=/images/cloudflare-images/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Cloudflare Images Documentation</span></a> to learn more about the many more features Cloudflare Images has to offer.</p><h2 id=obtain-cloudflare-images-api-credentials><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#obtain-cloudflare-images-api-credentials>&#8203;​</a></span>
<span>Obtain Cloudflare Images API credentials</span></h2><p>The bulk upload script featured in this tutorial needs Cloudflare Images API credentials in the form of two environment variables:</p><ul><li><code>CF_IMAGES_ACCOUNT_ID</code></li><li><code>CF_IMAGES_API_KEY</code>.</li></ul><p>You can get them both in your Cloudflare dashboard 👇:</p><h4 id=cf_images_account_id><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#cf_images_account_id>&#8203;​</a></span>
<span><code>CF_IMAGES_ACCOUNT_ID</code></span></h4><p>This refers to your Cloudflare Image account ID. You can get this value in your Cloudflare Images dashboard.</p><p><img src=/images/static/tutorials/integrate-cloudflare-images/step-02-accountid.jpg alt="Where to find your Cloudflare Images account ID"></p><h4 id=cf_images_api_key><span class=DocsMarkdown--header-anchor-positioner><a class="DocsMarkdown--header-anchor Link Link-without-underline" href=#cf_images_api_key>&#8203;​</a></span>
<span><code>CF_IMAGES_API_KEY</code></span></h4><p>This value refers to a Cloudflare API token, with <code>Read</code> and <code>Update</code> permissions for Cloudflare Images. If you do not have one yet, refer to <a href=/images/cloudflare-images/api-request/ class=DocsMarkdown--link><span class=DocsMarkdown--link-content>Make your first API request</span></a> to learn how to create a Cloudflare API token.</p></article></div></main><footer class=DocsFooter><div class=DocsFooter--content><div class=DocsFooterResources><span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/images" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Cloudflare Dashboard</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://discord.com/channels/595317990191398933/973591562615390228 class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Discord</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://community.cloudflare.com/c/developers/images class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Community</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href=https://www.cloudflare.com/learning/ class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Learning Center</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-additional-wrapper><a href="https://dash.cloudflare.com/?to=/:account/support" class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Support Portal</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span></div><div><span class=DocsFooter--edit-on-gh-link-wrapper><a href=https://github.com/panthere2k/panthere2k.github.io/blob/content/content/images/cloudflare-images/tutorials/integrate-cloudflare-images.md class=DocsMarkdown--link target=_blank rel=noopener><span class=DocsMarkdown--link-content>Edit on GitHub</span><span class=DocsMarkdown--link-external-icon aria-hidden=true><svg fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg"><title id="title-4744738674102027">External link icon</title><path d="M6.75 1.75h-5v12.5h12.5v-5m0-4v-3.5h-3.5M8 8l5.5-5.5"/></svg>
<span is-visually-hidden>Open external link</span></span></a></span>
<span class=DocsFooter--content-dot-spacer>&nbsp; · &nbsp;</span>
<span class=DocsFooter--content-time>Updated <time class=relative datetime=2023-01-02T09:58:19+09:00 title=2023-01-02>January 2, 2023</time></span></div></div></footer></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKQFGQB" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-PKQFGQB")</script><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=preload href=https://unpkg.com/littlefoot/dist/littlefoot.css as=style></noscript><script defer src=https://unpkg.com/littlefoot/dist/littlefoot.js type=application/javascript></script>
<script type=application/javascript>document.addEventListener("DOMContentLoaded",()=>littlefoot.default())</script></body></html>